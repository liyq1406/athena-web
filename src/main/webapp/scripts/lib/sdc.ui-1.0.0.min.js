(function(a){function b(e,d){var b=a("#youi_log");b.length==0&&(b=a('<div class="youi-log" id="youi_log"></div>').appendTo(a("body",document)));b.prepend('<div class="'+(d.type||"")+'">'+b.find("div").length+":"+e+"</div>");b.dialog({autoOpen:true,width:600,title:"\u65e5\u8bb0",modal:false,minHeight:300}).show().dialog("open")}function c(e){var d=a("#youi_loading");d.length||(d=a('<div class="youi-loading" id="youi_loading"/>').appendTo(a("body",document)));e=e||a.sdcui.resourceUtils.get("loading");
a("body",document).addClass("show-loading");d.show().text(e).css({height:Math.max(a(window).height(),a("body",document).height())})}function g(){a("#youi_loading").hide("slow");a("body",document).removeClass("show-loading")}function f(e,d){for(var b=e,c=0;c<d.length;c++)b=a.sdcui.parameterUtils.connectParameter(b,d[c].property,d[c].value);return b}a.sdcui=a.sdcui||{};a.sdcui.getMessage=function(e,d){if(arguments.length==1)return function(){var d=a.makeArray(arguments);d.unshift(e);return a.sdcui.getMessage.apply(this,
d)};arguments.length>2&&d.constructor!=Array&&(d=a.makeArray(arguments).slice(1));d.constructor!=Array&&(d=[d]);a.each(d,function(a,d){e=e.replace(RegExp("\\{"+a+"\\}","g"),""+d)});return e};a.extend(a.sdcui,{version:"1.0.0",serverConfig:{contextPath:"",convertArray:[]},resource:{keyboardClass:"field-tab",keyboardFocusClass:"field-tabed",keyboardContainerClass:"keyboard-container"},pageUtils:{goPage:function(e){e=a.extend({mode:"form",method:"post"},e);if(e.url&&(!a.isFunction(e.beforeSubmit)||e.beforeSubmit.apply(e))){var d=
e.url;e.url.indexOf("/")==0&&(d=a.sdcui.serverConfig.contextPath+d);var b=a.sdcui.recordUtils.recordToParameters(e.record);switch(e.mode){case "form":e=['<form method="'+e.method+'" id="page_goPage_form_" action="'+d+'"'];e.push(">");for(d=0;d<b.length;d++)e.push('<input name="'+b[d].property+'" value="'+b[d].value+'"/>');e.push("</form>");a("body",document).append(e.join(""));a("#page_goPage_form_").submit().remove();break;case "dialog":var c=a("#page_goPage_dialog_"),g=e.width||600,h=e.height||
200;c.length==0&&(c=['<iframe frameborder="0" width="'+g+'" height="'+h+'"'],c.push("></iframe>"),c=a("<div>"+c.join("")+"</div>").appendTo("body",document),c.dialog({autoOpen:false,hideCloseIcon:e.hideCloseIcon,width:g+28,title:e.caption,modal:true,minHeight:h+40,overlay:{opacity:0.2,background:"#A8A8A8"},zIndex:9999,close:e.close}));c.find("iframe").attr("src",f(d,b));c.show().dialog("open");break;case "modal":_openModalDialog(e,d,b);break;case "location":window.location.href=f(d,b);break;default:window.open(f(d,
b),e.windowArgs)}}}},resourceUtils:{get:function(b){var d=a.sdcui.resource[b];return!d?"":a.isFunction(d)?d(Array.prototype.slice.call(arguments,1)):d}},logLevel:{info:false,debug:false,warn:false,error:false},log:{info:function(e){a.sdcui.logLevel.info===true&&b(e,{type:"info"})},debug:function(e){a.sdcui.logLevel.debug===true&&b(e,{type:"debug"})},warn:function(e){a.sdcui.logLevel.warn===true&&b(e,{type:"warn"})},error:function(e){a.sdcui.logLevel.error===true&&b(e,{type:"error"})}},buttonUtils:{addButtonActionListener:function(b,
d){b.bind("click",{actions:d},function(d){var b=a.sdcui.classUtils.getEventClass(d),e=d.data.actions;if(e){var c;a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor();a.isFunction(window["func_button_"+b])?c=window["func_button_"+b]:typeof e[b]=="string"?c=window[e[b]]:a.isFunction(e[b])&&(c=e[b]);c&&a(d.target).parents(".youi-button.disabled").length==0&&c.apply(d.target);return false}})},createButton:function(b){var d=[],c=["youi-button",b.disabled?"disabled":""].concat(b.buttonStyles);d.push('<div id="button_'+
b.name+'" class="'+c.join(" ")+'"><div class="right"><div class="center"><a href="#"');d.push('class="'+b.name+" "+(b.icon?"icon "+b.icon:"")+'"');d.push(">");d.push(b.caption);d.push("</a></div></div></div>");a.isFunction(b.action)&&a.actionFactory.register(b.id,b.action);return d.join("")},createButtons:function(b){var d=[];if(a.isArray(b)){d.push('<table cellpadding="1" cellspacing="0">');d.push("<tr>");for(var c=0;c<b.length;c++)d.push("<td>"),d.push(a.youi.buttonUtil.createButton(b[c])),d.push("</td>");
d.push("</tr>");d.push("</table>")}return d.join("")}},recordUtils:{parseRecords:function(b,d){if(!a.isArray(b)||b.length==0)return"";var c,f,g=[],h=d.propertyDescriptor;h||(g=b);for(var l=[],n=0;n<b.length;n++){c=b[n];if(h){f={};for(var o in h)f[o]=c[h[o]];g.push(f)}else f=c;if(a.isFunction(d.parseRecord)){f=d.parseRecord(n,f,d)||"";c=[];c=a.isArray(f)?f:[f];for(f=0;f<c.length;f++)l[f]=!l[f]?[]:l[f],l[f].push(c[f]||"")}}return a.isFunction(d.parse)?d.parse(g,l,d):""},getPropertyValue:function(a,
d){if(d){var b,c=d.split(".");if(c.length>1){b=a;for(var f=0;f<c.length;f++)if(b=b[c[f]],!b)return}else b=a[d];return b}},recordToParameters:function(b){var d=[];if(b)for(var c in b){var f=b[c];f&&(typeof f=="string"?d.push({property:c,value:f}):f&&a.isArray(f)&&(typeof f[0]=="object"?a(f).each(function(a){for(var b in this)d.push({property:c+"["+a+"]."+b,value:this[b]})}):a(f).each(function(a){d.push({property:c+"["+a+"]",value:this})})));f=null}return d}},formatUtils:{from:function(a,d){isFinite(a)&&
(a=parseFloat(a));return!isNaN(a)?a:d},usMoney:function(b){return a.sdcui.formatUtils.currency(b,"$",2)},cnMoney:function(b){return a.sdcui.formatUtils.currency(b,"\uffe5",2)},currency:function(b,d,c){var f="",g=",0",h=0;b-=0;b<0&&(b=-b,f="-");c=c||2;g+=g+(c>0?".":"");for(h=0;h<c;h++)g+="0";b=a.sdcui.formatUtils.number(b,g);return f+(d||"\uffe5")+b},number:function(b,d){var c,f=/[^\d\.]/g;if(!d)return b;b=a.sdcui.formatUtils.from(b,NaN);if(isNaN(b))return"";var g=b<0,h,b=Math.abs(b);d.substr(d.length-
2)=="/i"?(c||(c=RegExp("[^\\d\\.]","g")),d=d.substr(0,d.length-2),h=d.indexOf(",")!=-1,c=d.replace(c,"").split(".")):(h=d.indexOf(",")!=-1,c=d.replace(f,"").split("."));1<c.length?b=b.toFixed(c[1].length):2<c.length?alert("Invalid number format, should have no more than 1 decimal"):b=b.toFixed(0);f=b.toString();c=f.split(".");if(h){h=c[0];var f=[],l=h.length,n=Math.floor(l/3),o=h.length%3||3,p;for(p=0;p<l;p+=o)p!==0&&(o=3),f[f.length]=h.substr(p,o),n-=1;f=f.join(",");c[1]&&(f+="."+c[1])}else c[1]&&
(f=c[0]+"."+c[1]);g&&(g=f.replace(/[^1-9]/g,"")!=="");return(g?"-":"")+d.replace(/[\d,?\.?]+/,f)}},classUtils:{hasClass:function(a,d){return!a?false:(" "+a.className+" ").indexOf(" "+d+" ")!=-1},getEventClass:function(a){if(a)return(a=a.target.className)&&(a=a.split(" ")[0]),a}},popUtils:{showPopBackground:function(){var b=a("#youi-pop-background");b.length==0&&(b=a('<div id="youi-pop-background"></div>').appendTo(a("body",document)),b.disableSelection());var d=Math.max(a(window).height(),a("body",
document).height());b.show().css("height",d)},hidePopBackground:function(){a("#youi-pop-background").length&&a("#youi-pop-background").hide()}},parameterUtils:{propertyParameter:function(b,d){var c=[];a.isArray(d)?a(d).each(function(){this!=null&&c.push(""+b+"="+encodeURIComponent(this))}):d&&c.push(""+b+"="+encodeURIComponent(d));return c.join("&")},connectParameter:function(b,d,c){return b+(b.indexOf("?")==-1?"?":"&")+a.sdcui.parameterUtils.propertyParameter(d,c)}},dimensionUtil:{parseWidth:function(a,
d){return typeof d=="string"&&d.indexOf("%")!=-1?a.parent().width()*parseInt(d)/100:d}},messageUtil:{showMessage:function(a){a&&alert(a)},showError:function(a){a&&alert(a)}},ajaxUtil:{ajax:function(b,d){c(b.wait);(d=d||a.browser.msie?true:false)&&b.data&&(b.data+="&youi-timeStamp="+(new Date).getTime());if(a.sdcui.serverConfig.contextPath&&b.url.substring(0,1)=="/"&&b.url.indexOf(a.sdcui.serverConfig.contextPath)==-1)b.url=a.sdcui.serverConfig.contextPath+b.url.substring(1);var f=a.extend({},{dataType:"json",
type:"POST",contentType:"application/x-www-form-urlencoded;charset=UTF-8",error:function(){}},b),j=f.success||function(){},k=f.error||function(){},h=f.domainValidator||function(){};f.complete=function(d,b){if(b=="error"){var c=a.sdcui.resourceUtils.get("urlNotFound",this.url);a.sdcui.messageUtil.showError(c);this.error.apply(f,[c])}else if(d.getResponseHeader("sessionstatus")=="timeout")a.sdcui.messageUtil.showMessage("\u767b\u5f55\u8fc7\u671f"),window.location.href=window.location.href;g()};f.success=
function(d){g();if(d!=null)if(d.hasError)a.sdcui.messageUtil.showError(d.errorMsg),k.apply(f,[d.errorMsg]);else{d.result&&d.result.message&&a.sdcui.messageUtil.showMessage(d.result.message);var b=d.message;if(b&&b.code){var c=b.code;switch(c){case "000000":b.passed==null&&a.sdcui.messageUtil.showMessage(b.info);break;case "111111":a.sdcui.messageUtil.showMessage(c+":"+b.info);window.location.href=window.location.href;return;case "111112":h.apply(f,[d]);return;default:a.sdcui.messageUtil.showError(b.info);
k.apply(f,[b.info]);return}}j.apply(f,[d])}};a.ajax(f)}},dragSupport:{_doDrag:function(a){if(a[0]!=this.currentDrag[0]&&(this.currentDrop&&this.currentDrop[0]!=a[0]&&this._dropOut(),!this.currentDrop||this.currentDrop[0]!=a[0]))this.currentDrop=a,this._dropOver()},_releaseDrop:function(){this.currentDrop&&this._dropOut();this.currentDrop=null},_dropOver:function(){this.helper&&this.helper.addClass("drop-yes");this.currentDrop&&this.currentDrop.addClass("droping")},_dropOut:function(){this.helper&&
this.helper.removeClass("drop-yes");this.currentDrop&&this.currentDrop.removeClass("droping")},_createHelper:function(b,d){var c=a('<div class="drop-yes" id="drag_helper"></div>').append(d.clone());c.parents("body").length||c.appendTo(this.options.container?this.options.container:this.currentDrag);c[0]!=this.element[0]&&!/(fixed|absolute)/.test(c.css("position"))&&c.css("position","absolute");return c},_generatePosition:function(a){var d=a.pageX,a=a.pageY,b=this.options.container?this.options.container.offset():
this.element.offset(),b=b?b:{top:0,left:0};return{top:a+10-b.top,left:d+5-b.left}}},dataParser:{parseRecords:function(a,d,b){if(a.result){for(var a=a.result.rows,c=a.length,f=[],h=0;h<c;h++)f.push(d(h,a[h],b));return f.join("")}}}})})(jQuery);
(function(a){this.version="1.0.0";this.actions=[];this.register=function(b,c,g){a.isFunction(c)&&(g=c,c={});this.actions[b]=function(a){g.apply(this,[a])};return this};this.execute=function(a,c,g){this.actions[a]&&(g=g||[],this.actions[a].apply(c,g));return this};this.remove=function(){return this};a.actionFactory=this;return a})(jQuery);(function(a){a.sdcui.fieldUtils={getInstance:function(b){return(b=a(b))&&b.is(".youi-field")?a.data(b[0],b.attr("fieldType")):null},execMethod:function(b,c){if(!(b===null||c===null||typeof c!="string")){var g=a.sdcui.fieldUtils.getInstance(b);if(g!==null&&g._init&&g[c]){var f=Array.prototype.slice.call(arguments,2);g[c].apply(g,f)}}},getElementByProperty:function(b,c){var g=a.sdcui.fieldUtils.getFieldId(b,c);return a.sdcui.fieldUtils.getElementById(g)},getElementById:function(b){return a(document.getElementById(b))},
getFieldId:function(a,c){return(c?c:"field")+"_"+a.replace(/\./g,"_")}};a.extend(jQuery.fn,{fieldValue:function(b,c){var g=a.sdcui.fieldUtils.getInstance(this);if(g)if(arguments.length==0)return g.getValue();else g.setValue(b,c);return null},fieldDefaultValue:function(b){var c=a.sdcui.fieldUtils.getInstance(this);if(c&&b)c.options.defaultValue=b},fieldShow:function(){var b=a.sdcui.fieldUtils.getInstance(this);return b?b.getText()||b.getValue():null},fieldReset:function(b){this.each(function(){var c=
a.sdcui.fieldUtils.getInstance(this);c&&!(b==true&&c.options.escapeReset==true)&&c.reset&&c.reset()})},fieldFocus:function(){var b=a.sdcui.fieldUtils.getInstance(this);b&&b.focus()},fieldValidate:function(){this.each(function(){var b=a.sdcui.fieldUtils.getInstance(this);b&&b.validate&&b.validate()})},fieldClear:function(){this.each(function(){var b=a.sdcui.fieldUtils.getInstance(this);b&&b.clear()})},fieldWidth:function(b){var c=a.sdcui.fieldUtils.getInstance(this);if(c)if(arguments.length==0)return c.getWidth();
else c.setWidth(b);return null},fieldDisabled:function(){this.each(function(){var b=a.sdcui.fieldUtils.getInstance(this);b&&b.disabled&&b.disabled()})},fieldEnable:function(){this.each(function(){var b=a.sdcui.fieldUtils.getInstance(this);b&&b.enable()})}});a.sdcui.field={_create:function(){this.options.id=this.options.id||a.sdcui.fieldUtils.getFieldId(this.options.property,this.options.prefix);this.element.attr("fieldType",this.widgetName).attr("property",this.options.property);this._defaultHtmls();
this._initField();this._initAction();this.reset()},_defaultHtmls:function(){if(this.options.initHtml!==false){var a=this._fieldHtmls(),c=["youi-field",this.widgetName];this.options.notNull==true&&c.push("notNull");this.element.attr("id",this.options.id).addClass(c.join(" ")).html(a)}},_fieldHtmls:function(){return""},_initField:function(){},_initAction:function(){},_validateNotNull:function(){if(this.options.notNull==null)return true;var b=this.getValue();if(this.options.notNull==true){if(a.isArray(b)&&
b.length==0)return this._validateError("\u4e0d\u80fd\u4e3a\u7a7a"),false;if(typeof b=="string"&&(b==null||a.trim(b)==""))return this._validateError("\u4e0d\u80fd\u4e3a\u7a7a"),false}return true},_validateSuccess:function(){this.element.removeClass("validate-error").addClass("validate-success").removeAttr("title")},_validateError:function(a){a=a||"";this.element.removeClass("validate-success").addClass("validate-error").attr("title","\u3010"+this.options.caption+"\u3011"+a)},_validating:function(){this.element.removeClass("validate-success").removeClass("validate-success").addClass("validating").removeAttr("title")},
getValue:function(){},setValue:function(){},getText:function(){},setText:function(){},clear:function(){},focus:function(){},validate:function(){this.element.removeClass("validate-success").removeClass("validate-error").removeAttr("title");this._validateNotNull()},reset:function(){this.element.removeClass("validate-success").removeClass("validate-error").removeAttr("title");this.options.defaultValue!=null?this.setValue(this.options.defaultValue,this.options.defaultShow):this.clear()},setWidth:function(a){this.element.width(a).find(".textInput").width(a)},
disabled:function(){this.element.addClass("disabled").find(".textInput").attr("disabled","disabled")},enable:function(){this.element.removeClass("disabled").find(".textInput").removeAttr("disabled","disabled")},destory:function(){this.element.removeClass("youi-field").removeAttr("fieldType").removeAttr("property");a.widget.prototype.destroy.apply(this,arguments)}};a.sdcui.fieldSource={children:[],_fieldHtmls:function(){var a=this.options.width-11,c=this.options.showProperty,g=[];g.push('<table cellpadding="0" cellspacing="0" width="'+
a+'"><tbody><tr>');g.push('<td valign="top" width="'+(a-15)+'"><input style="width:'+(a-15-4)+'px;" type="text" ');g.push(c==null?"":'showProperty="'+c+'"');g.push(' readonly="readonly" class="textInput"/><input name="'+this.options.property+'" type="hidden" class="value"/></td>');g.push('<td class="youi-icon select-down" width="15px"><div></div></td>');g.push("</tr></tbody></table>");this.element.html(g.join(""))},_initSource:function(){this._getPopPanel&&this._getPopPanel();this.children=[];var b=
this.options.parents;if(a.isArray(b)&&b.length>0)for(var c,g=0;g<b.length;g++)(c=a.sdcui.fieldUtils.getElementByProperty(b[g],this.options.prefix))&&a.sdcui.fieldUtils.execMethod(c,"_addChild",this.options.property)},_addChild:function(a){this.children.push(a)},_resetChildren:function(){var b=this.children;if(a.isArray(b)&&b.length>0)for(var c,g=0;g<b.length;g++)(c=a.sdcui.fieldUtils.getElementByProperty(b[g],this.options.prefix))&&a.sdcui.fieldUtils.execMethod(c,"_reloadByParent",this.options.property)},
_reloadByParent:function(){this.reset();this._disposeLoaded();this._resetChildren()},_getDatasContextId:function(){return this.id+"-datasContext"},_parseRecords:function(b,c){var g=this._getDatasContextId();a("#"+g).removeClass("item-srcoll");var f={property:this.options.property,propertyDescriptor:{code:this.options.code,show:this.options.show},parseRecord:this._parseRecord,selectedValue:this.getValue(),selectedTexts:[],datasContextId:g,fieldId:this.options.id,mixed:this.options.mixed,parse:function(d,
b,c){d.length>10&&a("#"+c.datasContextId).addClass("item-srcoll");c.selectedTexts.length>0&&a.sdcui.fieldUtils.execMethod(a("#"+c.fieldId),"setText",c.selectedTexts.join());return b[0].join("")}},e=[];this.options.notNull!=true&&e.push(this._nullItemHtml());e.push(a.sdcui.recordUtils.parseRecords(b,f));g=a("#"+g);g[0].innerHTML=e.join("");g.addClass("loaded "+(c?"expanded":""));c&&g.css("display","block")},_parseRecord:function(){},_nullItemHtml:function(){return""},_isLoaded:function(){var b=this._getDatasContextId();
return a("#"+b).hasClass("loaded")},_disposeLoaded:function(){a("#"+this._getDatasContextId()).removeClass("loaded")},_datasLoader:function(a){this.options.convert?this._convertLoader(a):this.options.src&&this._ajaxLoader(a)},_convertLoader:function(){var b=a.sdcui.serverConfig.convertArray[this.options.convert];if(b){var c=[];this.options.code="code";this.options.show="show";for(var g in b)c.push({code:g,show:b[g]});this._parseRecords(c)}},_ajaxLoader:function(b){var c=this.options.src,g=[],g=this._getParentParameters();
if(!g)return false;g=[].concat(g);a.sdcui.ajaxUtil.ajax({fieldId:this.options.id,url:c,data:g.join("&"),success:function(c){if(c&&a.isArray(c.result)){var e=a.sdcui.fieldUtils.getElementById(this.fieldId);a.sdcui.fieldUtils.execMethod(e,"_parseRecords",c.result,b)}}})},_getParentParameters:function(){var b=[],c=this.options.parents,g=this.options.parentsAlias||[],f;if(a.isArray(c)&&c.length>0){for(var e,d,i=[],j=0;j<c.length;j++)if((e=a.sdcui.fieldUtils.getElementByProperty(c[j],this.options.prefix))&&
e.length)d=e.fieldValue(),f=g[j]||c[j],d||(e=a("label[for="+e.attr("fieldtype")+"-"+e.attr("id")+"]"),i.push(e.text())),b.push(a.sdcui.parameterUtils.propertyParameter(f,d));if(i.length)throw"\u8bf7\u5148\u9009\u62e9\u3010"+i.join().replace("\uff1a","")+"\u3011";}return b},reset:function(){var b=this.options.parents;a.isArray(b)&&b.length>0&&(b=this._getDatasContextId(),a("#"+b).removeClass("loaded"));a.sdcui.field.reset.apply(this)}};a.sdcui.fieldPop=a.extend({},a.sdcui.fieldSource,{_fieldHtmls:function(){var a=
[],c=this.options.width-11;a.push('<table class="fieldPop-table" cellpadding="0" cellspacing="0" width="'+c+'"><tbody><tr>');a.push('<td valign="top" width="'+(c-15)+'"><input readonly="readonly" style="width:'+(c-15-6)+'px;" type="text" class="textInput fieldPop"></input><input  name="'+this.options.property+'" type="hidden" class="value"></input></td>');a.push('<td class="youi-icon select-down" width="15px"><div></div></td>');a.push("</tr></tbody></table>");return a.join("")},_initAction:function(){this.options.readonly!=
true&&(this.element.bind("click",function(){!a(this).hasClass("readonly")&&!a(this).hasClass("disabled")&&a.sdcui.fieldUtils.execMethod(this,"_togglePanel")}),a("body",document).hasClass("event-fieldPop")||(a(document).bind("mousedown",function(b){a(".field-items-panel").removeClass("expanded");a(".field-items-panel").css("display","none");a.sdcui.popUtils.hidePopBackground();b.target.getAttribute("id")==="youi-pop-background"&&a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor()}),a(window).bind("resize",
function(){a(".field-items-panel").removeClass("expanded");a(".field-items-panel").css("diplay","none");a.sdcui.popUtils.hidePopBackground()}),a("body",document).addClass("event-fieldPop")),this._initPanelAction())},_togglePanel:function(){if(this.options.popup!=false){var a=this._getPopPanel();a.toggleClass("expanded").hasClass("expanded")||a.css("display")=="none"?this._openPanel():this._closePanel()}},_openPanel:function(){var b=this._getPopPanel();if(this._isLoaded()){b.find(".selected").removeClass("selected");
for(var c=this.getValue(),g=[],g=a.isArray(c)?c:[c],c=0;c<g.length;c++)b.find('.option-item[value="'+g[c]+'"]').addClass("selected")}else try{this._datasLoader(true)}catch(f){b.empty();alert(f);return}this._setPanelPosition();b.addClass("expanded");b.css("display","block");a.sdcui.popUtils.showPopBackground(a(window).width()-10)},_closePanel:function(){this.options.popup!=false&&(this._getPopPanel().removeClass("expanded"),this._getPopPanel().css("display","none"),a.sdcui.popUtils.hidePopBackground())},
_getPopPanel:function(){var b=this._getPanelId(),c=a("#"+b);c.length==0?(c=a('<div fieldId="'+this.options.id+'" style="width:'+(this.options.width-11)+'px;" id="'+b+'" class="field-items-panel"></div>').appendTo(a("body",document)),c.html(this._popPanelHtmls())):this.options.popup&&!c.parent().is("body")&&c.appendTo(a("body",document));return c},_popPanelHtmls:function(){return""},_getPanelId:function(){return"field-pop-"+this.options.id},_setPanelPosition:function(){this._getPopPanel().css({left:this.element.offset().left,
top:this.element.offset().top+this.element.innerHeight()-1})},_initPanelAction:function(){},setText:function(a){this.element.find("input.textInput").val(a)},getText:function(){return this.element.find("input.textInput").val()},clear:function(){this.element.find("input.textInput,input.value").val("")},focus:function(){},setWidth:function(a){this.element.find("table").attr("width",a+"px").find("td:first").attr("width",a-15+"px");this._getPopPanel().width("width",a);this.element.width(a).find(".textInput").width(a-
15)}});a.sdcui.fieldDefaults={width:200};a.sdcui.fieldSourceDefaults=a.extend({},a.sdcui.fieldDefaults,{show:"show",value:"value"});a.sdcui.fieldPopDefaults=a.extend({},a.sdcui.fieldSourceDefaults,{popup:true});a.widget("youi.fieldCustom",a.extend({},a.sdcui.field,{_initField:function(){},setValue:function(a){this.options.setValue(a)},getValue:function(){return this.options.getValue(value)},clear:function(){this.options.clear(value)}}))})(jQuery);(function(a){this.version="1.0.0";this.editors={};this.register=function(a,c){this.editors[a]=$.extend({editor:a},c);this.editors[a].create.apply(this.editors[a]);return this};this.open_=function(a){a=$.extend({name:"fieldText",property:"fieldText"},a);a.property="e_"+a.property;if((this.openEditor=this.editors[a.name])&&$.isFunction(this.openEditor.open))this.openEditor.col=a,this.openEditor.open.apply(this.openEditor,[a]);this.openEditor=this.editors[a.name];return this};this.closeEditor=function(){this.openEditor&&
(this.openEditor.close.apply(this.openEditor),$.isFunction(this.openEditor.col.closeEvent)&&this.openEditor.col.closeEvent.apply(this.openEditor,[this.openEditor.col.value,this.openEditor.col.text]));this.openEditor=null;return this};a.sdcui.editorFactory=this;return a})(jQuery);
(function(a){a.widget("sdcui.editor",{options:{editorClass:"cell"},_create:function(){this.element.addClass("youi-editor");this._initAction()},_initAction:function(){this.element.bind("editor.open",function(c,b,f){a(this).editor("close");b.addClass("editing");f.cell=b;(!f.openEvent||a.isFunction(f.openEvent)&&f.openEvent.apply(this,[c,b,f]))&&a.sdcui.editorFactory.open_(f)}).bind("editor.close",function(c,b){b.removeClass("editing");a.sdcui.editorFactory.closeEditor()})},open:function(){var a=this.element.find("."+
this.options.editorClass+".editing");a.length==0&&(a=this.element.find("."+this.options.editorClass+":first"));this.element.trigger("editor.open",[a])},close:function(){this.element.trigger("editor.close",[this.element.find(".editing")]);return true}});var b={create:function(){},open:function(b){this.cell=b.cell;this.cell.offset();var g=this.cell.offset().left,f=a(this.cell).parents(".youi-grid:first").find(".grid-scroll"),e=b.name,b=a.extend({property:"editor_"+e},b),d="editorPanel_"+e+"_"+b.property.replace(/\./g,
"_");this.editorPanel=a("#"+d);var i=this.cell.attr("value")||this.cell.text();if(this.editorPanel.length==0)b.change=function(d){d&&a.sdcui.editorFactory.closeEditor()},b.afterSetValue=function(){a.sdcui.editorFactory.closeEditor()},b.select=function(d){d&&a.sdcui.editorFactory.closeEditor()},this.editorPanel=a('<div class="editorPanel" id="'+d+'"></div>').appendTo(a("body",document)),this.editorPanel.append(a("<div></div>")[e](b)),this.cell.offset().left>g&&f.scrollLeft(this.cell.offset().left-
g),b.isCheck===true&&this.editorPanel.css("display","none"),this.editorPanel.bind("mousedown",function(a){a.stopPropagation()});g=this.editorPanel.find(">div");g.fieldValue(i);g[e]("setWidth",this.cell.innerWidth()-5);g[e]("setHeight",this.cell.innerHeight()-2);b.isCheck!==true&&this.editorPanel.css({top:this.cell.offset().top,left:this.cell.offset().left,height:this.cell.innerHeight(),width:this.cell.innerWidth()}).show();g.fieldFocus()},close:function(){if(this.editorPanel&&this.editorPanel.length){var b=
this.editorPanel.find(">div.youi-field");b.fieldValidate();a("body>.editorPanel").hide();var g=a.trim(b.fieldValue()||""),f=a.trim((b.fieldShow()||"").toString()).replace(/\s/g,"&nbsp;"),e=this.cell.attr("value")||this.cell.text();if(this.col){var d=this.col.renderer;if(d){if(typeof d==="string")col.renderer=d=a.sdcui.formatUtils[d];typeof d==="function"&&(f=d.call(this.col,g,this.col.record,this.col.rowIndex,this.col.colIndex))}}this.cell.not(".edited").length==1&&e!=g?(this.cell.addClass("edited"),
this.cell.html(f).attr("value",g)):this.cell.is(".edited")&&this.cell.html(f).attr("value",g);this.col.value=g;this.col.text=f;if(b.hasClass("validate-error"))return b=a.sdcui.resourceUtils.get("grid.editor.errorMessage",this.col.rowIndex,this.col.colIndex,b.attr("title")),this.cell.addClass("validate-error").attr("title",b),false;else this.cell.attr("title",f).removeClass("validate-error")}}};a.each(["fieldText","fieldSelect","fieldCalendar","fieldPassword"],function(){a.sdcui.editorFactory.register(this,
b)});a.sdcui.editorFactory.register("form",{create:function(){},open:function(b){var g=a("#"+b.formId),f=b.cell,e=f.parents(".youi-editor:first"),d=b.beforeSubmit;g.form("open").form("reset");g.form("fieldValue","code",f.attr("value")||f.text());g.form("fieldValue","show",f.text());g.hasClass("form-dailog-opened")||(g.addClass("form-dailog-opened"),window[b.formId+"_beforeSubmit"]=function(){var b=a(this).form("getFormRecord");if(!(a.isFunction(d)&&d.apply(this,[b])===false)){var c=e.find(".editing:first");
c.addClass("edited").attr("value",b.code);c.html(b.show||b.code);a(this).form("close")}})},close:function(){}})})(jQuery);(function(a){a.widget("sdcui.fieldAutocomplete",a.extend({},a.sdcui.field,a.sdcui.fieldSource,{_initField:function(){var b=this;this._initSource();this.element.find("input.textInput").autocomplete({source:this.options.src,code:this.options.code,show:this.options.show,term:this.options.property,select:function(a,g){var f=g.item;b.setValue(f.label,f.value)},search:function(){a(this).next().val("")},change:function(){a(this).next().val()||a(this).val("")},close:function(){a(this).next().val()||b.reset()}})},
_fieldHtmls:function(){var a=[];a.push('<input style="width:'+(this.options.width-17)+'px;" type="text" class="textInput"></input>');a.push('<input type="hidden" class="value"></input>');a.push('<div class="field-invalid"></div>');return a.join("")},setValue:function(a,c){this.element.find("input.textInput").val(c||a);this.element.find("input.value").val(a);this._resetChildren()},_reloadByParent:function(){this.clear();this._disposeLoaded();this._resetChildren()},getValue:function(){return this.element.find("input.value").val()},
clear:function(){this.element.removeClass("validate-success").removeClass("validate-error").removeAttr("title");this.element.find("input.value,input.textInput").val("")},_initAction:function(){}}));a.extend(a.sdcui.fieldAutocomplete,{defaults:a.extend({},a.sdcui.fieldDefaults,{})})})(jQuery);(function(a){a.widget("sdcui.fieldCalendar",a.extend({},a.sdcui.field,{_initField:function(){this.options.readonly!=true&&!this.element.hasClass("readonly")&&this.element.find("input.textInput").datepicker({format:this.options.format,select:this.options.select})},_fieldHtmls:function(){var a=[],c=this.options.width-11;a.push('<table cellpadding="0" cellspacing="0" width="'+c+'"><tbody><tr>');a.push('<td valign="top" width="'+(c-17)+'"><input style="width:'+(c-17-6)+'px;" type="text" class="textInput"></input><input type="hidden" class="value"></input></td>');
a.push('<td class="youi-icon select-down" width="17px"></td>');a.push("</tr></tbody></table>");return a.join("")},validate:function(){this.element.removeClass("validate-error").removeAttr("title");if(!this._validateNotNull())return false;var b=a.trim(this.getValue());if(b)return(b=a.sdcui.dateUtil.strToDate(b,this.options.format))?(this.setValue(a.sdcui.dateUtil.dateToStr(b,this.options.format)),true):(regMessage="\u9519\u8bef\u7684\u65e5\u671f\u683c\u5f0f",this._validateError(regMessage),false)},
_initAction:function(){this.element.find(".youi-icon.select-down").click(function(){(!a("input.textInput",this.parentNode).attr("readonly")||a("input.textInput",this.parentNode).attr("readonly")=="")&&(!a("input.textInput",this.parentNode).attr("disabled")||a("input.textInput",this.parentNode).attr("disabled")=="")&&a("input.textInput",this.parentNode).datepicker("openDatepickerPanel")})},setValue:function(a){this.element.find("input.textInput").val(a)},getValue:function(){return this.element.find("input.textInput").val()},
clear:function(){this.element.find("input.textInput").val("")},focus:function(){this.element.find("input.textInput").datepicker("openDatepickerPanel")},setWidth:function(a){this.element.find("table").attr("width",a+"px").find("td:first").attr("width",a-15+"px");this.element.width(a).find(".textInput").width(a-15)}}))})(jQuery);(function(a){a.widget("sdcui.fieldCheckboxGroup",a.extend({},a.sdcui.field,a.sdcui.fieldSource,{_initField:function(){this._initSource();this._datasLoader()},_fieldHtmls:function(){var a=[];a.push('<div id="'+this._getDatasContextId()+'"></div>');this.element.html(a.join(""))},_parseRecord:function(a,c,g){a=[];a.push('<div class="checkbox-item"><input type="checkbox" value="'+c.code+'" name="property:'+g.property+'">'+c.show+"</input></div>");return a.join("")},_getDatasContextId:function(){return"content_"+
this.options.id},setValue:function(b){this.element.find("input:checkbox[value="+(a.isArray(b)?b:[b]).join("],input:checkbox[value=")+"]").attr("checked","checked")},getValue:function(){var a=[];this.element.find("input:checkbox[checked]").each(function(){a.push(this.value)});return a},getText:function(){return this.element.find("input:checkbox[checked]").parent().text()},clear:function(){this.element.find("input:checkbox[checked]").removeAttr("checked")}}));a.extend(a.sdcui.fieldCheckboxGroup,{defaults:a.extend({},
a.sdcui.fieldDefaults,{})})})(jQuery);(function(a){a.widget("sdcui.fieldComboBox",a.extend({},a.sdcui.field,a.sdcui.fieldPop,{_initField:function(){this._initSource()},_parseRecord:function(b,c,g){var b=[],f=c.code,c=c.show,e=["option-item"],d=g.selectedValue;if(d!=null)for(var i=[],i=a.isArray(d)?d:[d],d=0;d<i.length;d++)if(f==i[d]){e.push("selected");g.selectedTexts.push(c);break}b.push('<div value="'+f+'" class="'+e.join(" ")+'">');b.push('<img class="youi-icon" src="'+a.sdcui.serverConfig.contextPath+'/images/s.gif"></img>');b.push(c);
b.push("</div>");return b.join("")},_getDatasContextId:function(){return"datasContext-"+this.options.id},_popPanelHtmls:function(){var b=[];b.push('<div class="datas-context" id="'+this._getDatasContextId()+'"></div>');b.push('<div class="youi-buttons">');b.push(a.sdcui.buttonUtil.createButtons([{name:"selectAll",caption:"\u5168\u9009"},{name:"clearAll",caption:"\u6e05\u7a7a"},{name:"close",caption:"\u5173\u95ed"}]));b.push("</div>");return b.join("")},_initPanelAction:function(){this._getPopPanel().mousedown(function(a){a.stopPropagation()}).bind("click",
function(b){var c=a.sdcui.eventUtil.getEventClass(b),g=this.getAttribute("fieldId");switch(c){case "option-item":a(b.target).toggleClass("selected");var f=[];a(".selected",this).each(function(){f.push(this.getAttribute("value"))});a.sdcui.fieldUtil.execMethod(a("#"+g),"setValue",f);break;case "event-youi-button":return a(b.target).hasClass("selectAll")?(f=[],a(".option-item",this).addClass("selected").each(function(){f.push(this.getAttribute("value"))}),a.sdcui.fieldUtil.execMethod(a("#"+g),"setValue",
f)):a(b.target).hasClass("clearAll")?(a(".selected",this).removeClass("selected"),a.sdcui.fieldUtil.execMethod(a("#"+g),"clear")):a(b.target).hasClass("close")&&a.sdcui.fieldUtil.execMethod(a("#"+g),"_closePanel"),false}})},setValue:function(b){if(a.isArray(b))if(this.element.find("input.value").val(b.join()),this._isLoaded()){for(var c=this._getPopPanel(),g=[],f=0;f<b.length;f++)g.push(c.find(".option-item[value="+b[f]+"]").text());this.setText(g.join());this.element.find("input.textInput").attr("title",
"\u5171\u9009\u62e9\u3010"+g.length+"\u3011\u6761\u8bb0\u5f55\uff1a\n "+g.join("\n "));this._resetChildren()}else this._datasLoader()},getValue:function(){var a=this.element.find("input.value").val();a!=null&&(a=a.split(","));return a},clear:function(){this.element.find("input").val("").removeAttr("title")}}));a.extend(a.sdcui.fieldComboBox,{defaults:a.extend({},a.sdcui.fieldPopDefaults,{})})})(jQuery);(function(a){a.widget("sdcui.fieldCustom",a.extend({},a.sdcui.field,{options:{},_initField:function(){},_fieldHtmls:function(){},setValue:function(b){a.isFunction(this.options.setValue)&&this.options.setValue.apply(this,[b])},getValue:function(){if(a.isFunction(this.options.getValue))return this.options.getValue.apply(this)},clear:function(){a.isFunction(this.options.clear)&&this.options.clear.apply(this)}}))})(jQuery);(function(a){a.widget("sdcui.fieldGrid",a.extend({},a.sdcui.field,{options:{parentsAlias:[]},_initField:function(){this.element.addClass("youi-field");this.options.mode=this.options.mode||"normal";if(this.options.gridId){var b=a("#"+this.options.gridId);this.element.empty().append(b)}},setValue:function(b){if(this.options.mode=="reload"){for(var b=this.options.parents,c,g=[],f,e=0;e<b.length;e++)c=a.sdcui.fieldUtils.getElementByProperty(b[e],this.options.prefix),f=this.options.parentsAlias[e]||b[e],
c&&c.length&&(parentValue=c.fieldValue()),f&&parentValue&&g.push(a.sdcui.parameterUtils.propertyParameter(f,parentValue));a("#"+this.options.gridId).grid("loadByParents",g)}else this.options.mode=="select"?a("#"+this.options.gridId).grid("setSelectedRecords",b):a("#"+this.options.gridId).grid("parseRecords",b)},getValue:function(){return this.options.mode=="select"?a("#"+this.options.gridId).grid("getSelectedRecords"):a("#"+this.options.gridId).grid("getFormRecords")},clear:function(){a("#"+this.options.gridId).grid("clearBatchData");
this.options.mode=="select"?a("#"+this.options.gridId).find(".selected").removeClass("selected"):a("#"+this.options.gridId).grid("parseRecords",[],0)},validate:function(){if(!this._validateNotNull())return false},_initAction:function(){}}));a.extend(a.sdcui.fieldGrid,{defaults:a.extend({},a.sdcui.fieldDefaults,{escapeSpecial:true})})})(jQuery);(function(a){a.widget("sdcui.fieldHidden",a.extend({},a.sdcui.field,{_initField:function(){},_fieldHtmls:function(){var a=[];a.push('<input name="'+this.options.property+'" type="hidden" class="value"></input>');return a.join("")},setValue:function(a){this.element.find("input.value").val(a)},getValue:function(){return this.element.find("input.value").val()},clear:function(){this.getValue()!==this.options.defaultValue&&this.element.find("input.value").val("")}}));a.extend(a.sdcui.fieldLabel,{defaults:a.extend({},
a.sdcui.fieldDefaults,{})})})(jQuery);(function(a){a.widget("sdcui.fieldLabel",a.extend({},a.sdcui.field,{_initField:function(){},_fieldHtmls:function(){var a=[];a.push('<a href="'+(this.options.href||"#")+'" target="'+this.options.target+'" class="textShow"></a>');a.push('<input name="'+this.options.property+'" type="hidden" class="value"></input>');return a.join("")},_initAction:function(){this.element.find("a.textShow").click(function(){a(this.parentNode).fieldLabel("goHref");a.browser.msie&&this.blur()})},goHref:function(){var b=
this.element.find("a.textShow").attr("href"),c=this.options.params;if(a.isArray(c)&&c.length>0){for(var g=[],f,e,d=0;d<c.length;d++)f=c[d],e=a.sdcui.fieldUtil.getElementByProperty(f,this.options.prefix).fieldValue(),e!=null&&g.push(a.sdcui.parameterUtil.propertyParameter(f,e));b+=b.indexOf("?")==-1?"?":"&";b+=g.join("&")}this.element.find("a.textShow")[0].href=b},setValue:function(a){this.element.find(".textShow").text(a);this.element.find("input.value").val(a)},getValue:function(){return this.element.find("input.value").val()},
clear:function(){this.element.find(".textShow").text("");this.element.find("input.value").val("")}}));a.extend(a.sdcui.fieldLabel,{defaults:a.extend({},a.sdcui.fieldDefaults,{target:"_self"})})})(jQuery);(function(a){function b(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b)return a[c];return null}var c=a.sdcui.log;a.widget("sdcui.fieldLayout",{options:{initHtml:true,columns:2},fields:[],_create:function(){this.fields=[];this._initFieldModels();this._defaultHtmls();this._initFields()},_initFieldModels:function(){if(this.options.fields&&this.options.fields.length){var b=this.options.fields,c=[],e=this.options.prefix;a(b).each(function(d){for(var i=a.sdcui.fieldUtils.getFieldId(this.property,e),j="",
k="",h=d-1;b[h];){if(b[h].type!="fieldHidden"){j=a.sdcui.fieldUtils.getFieldId(b[h].property,e);break}h--}for(d+=1;b[d];){if(b[d].type!="fieldHidden"){k=a.sdcui.fieldUtils.getFieldId(b[d].property,e);break}d++}if(this.parentProperties&&this.parentProperties.length){var l=[];a(this.parentProperties).each(function(){l.push(a.sdcui.fieldUtils.getFieldId(this))});this.parentIds=l}c.push(a.extend({id:i,type:"fieldText",column:1,nextField:k,prevField:j,prefix:e},this))});this.fields=c}},_defaultHtmls:function(){if(this.options.initHtml){var b=
a.sdcui.flcFactory.getContent("simple",this.fields,{columns:this.options.columns,showBorder:this.options.showBorder});this.element.addClass("youi-fieldLayout").html(b)}},_initFields:function(){var c=this.fields;this.element.find(".youi-field").each(function(){var f=this.getAttribute("id");if((f=b(c,f))&&a.sdcui[f.type])a(this)[f.type](f)})},validate:function(){this.element.find(".youi-field").fieldValidate();return this.element.find(".youi-field.validating,.youi-field.validate-error").length==0?true:
false},getFieldValues:function(){var c=[],f=this.fields;this.element.find(".youi-field").each(function(){var e=this.getAttribute("id"),e=b(f,e),d;a(this).hasClass("fieldCustom")&&(e={property:this.getAttribute("property")});if(e)d=a(this).fieldValue(),property=e.property,typeof d=="string"?c.push({property:property,value:d}):d&&d.length&&a(d).each(function(){c.push({property:property,value:this})})});return c},getFieldParamters:function(){var c=[],f=this.fields;this.element.find(".youi-field").each(function(){var e=
this.getAttribute("id"),e=b(f,e),d;a(this).hasClass("fieldCustom")&&(e={property:this.getAttribute("property")});if(e)d=a(this).fieldValue(),property=e.property,typeof d=="string"?c.push(a.sdcui.parameterUtil.propertyParameter(property,d)):d&&d.length&&a(d).each(function(){c.push(a.sdcui.parameterUtil.propertyParameter(property,d))})});return c},setFieldValues:function(b){this.element.find(".youi-field").each(function(){var f=this.getAttribute("property"),e=a("input.textInput",this).attr("showProperty"),
f=a.sdcui.recordUtils.getPropertyValue(b,f);if(f!=null&&!f.length==0)try{a(this).fieldValue(f,!e?e:f)}catch(d){c.info("\u8bbe\u7f6e\u503c\u5f02\u5e38\uff1a"+d)}})},fieldDefaultValue:function(a,b){var c=this.element.find('.youi-field[property="'+a+'"]');c.fieldDefaultValue(b);c.fieldReset()},reset:function(){this.element.find(".youi-field").fieldReset()},destroy:function(){a.widget.prototype.destroy.apply(this)}});a.extend(a.sdcui.fieldLayout,{getter:["getFieldValues","getFieldParamters"]});a.sdcui.flcFactory=
{getContent:function(b,c,e){switch(b){default:return a.sdcui.flcFactory.getSimpleContent(c,e)}},getSimpleContent:function(b,c){var e=[],d=0,i=0,j=[],k=c.columns*2,h=0;a(b).each(function(){if(this.type=="fieldHidden")e.push('<div fieldType="fieldHidden" class="youi-field fieldHidden" id="'+this.id+'"></div>');else{var a=Math.min(this.column*2,k),b=a-1;h+=a;i+=a;if(i>k){for(var c=k-(i-a),f=0;f<c;f++)j[d].push("<td></td>");h+=c;i=a}d=Math.ceil(h/k)-1;j[d]||(j[d]=[],i=a);j[d].push('<td class="field-label '+
(this.notNull?"notNull":"")+'"><label for="'+this.type+"-"+this.id+'">'+this.caption+"\uff1a</label></td>");j[d].push("<td");b>1&&j[d].push(' colspan="'+b+'" ');j[d].push('><div id="'+this.id+'" class="youi-field" fieldType="'+this.type+'"></div></td>');fieldOption=null}});var l=j.length;if(h<k*l)for(var n=0;n<k*l-h;n++)j[l-1].push("<td></td>");e.push("<table"+(c.showBorder?' class="showBorder"  border="1"':"")+' width="100%">');e.push("<tr>");for(n=0;n<k;n++)e.push('<td class="contral" style="'+
(n%2==0?"width:80px;":"")+'"></td>');e.push("</tr>");a(j).each(function(){e.push("<tr>");e=e.concat(this);e.push("</tr>")});e.push("</table>");return e.join("")}}})(jQuery);(function(a){a.widget("sdcui.fieldPassword",a.extend({},a.sdcui.field,{_initField:function(){},_fieldHtmls:function(){var a=[];a.push('<input style="width:'+(this.options.width-17)+'px;" type="password" class="textInput value"></input>');a.push('<div class="field-invalid"></div>');return a.join("")},setValue:function(a){this.element.find("input.value").val(a)},getValue:function(){return this.element.find("input.value").val()},reset:function(){this.element.find("input.value").val(this.options.defaultValue||
"")},clear:function(){this.element.find("input.value").val("")}}));a.extend(a.sdcui.fieldPassword,{defaults:a.extend({},a.sdcui.fieldDefaults,{})})})(jQuery);(function(a){a.widget("sdcui.fieldRadioGroup",a.extend({},a.sdcui.field,a.sdcui.fieldSource,{_initField:function(){this._initSource();this._datasLoader()},_fieldHtmls:function(){},_parseRecord:function(a,c,g){a=[];a.push('<input type="radio" '+(g.selectedValue==c.code?' checked="checked" ':"")+' value="'+c.code+'" name="property:'+g.property+'">'+c.show+"</input>");return a.join("")},_getDatasContextId:function(){return"content_"+this.options.id},setValue:function(a){this.element.find("input:radio[value="+
a+"]").attr("checked","checked")},getValue:function(){return this.element.find("input:radio[checked]").val()},clear:function(){this.element.find("input:radio[checked]").removeAttr("checked")}}));a.extend(a.sdcui.fieldRadioGroup,{defaults:a.extend({},a.sdcui.fieldDefaults,{})})})(jQuery);(function(a){a.widget("sdcui.fieldSelect",a.extend({},a.sdcui.field,a.sdcui.fieldPop,{_initField:function(){this._initSource()},_parseRecord:function(b,c,g){var b=[],f=c.code,c=g.mixed?c.show+"("+f+")":c.show,e=["option-item"],d=g.selectedValue;if(d!=null)for(var i=[],i=a.isArray(d)?d:[d],d=0;d<i.length;d++)if(f==i[d]){e.push("selected");g.selectedTexts.push(c);break}b.push('<div value="'+f+'" class="'+e.join(" ")+'">'+c+"</div>");return b.join("")},_nullItemHtml:function(){return'<div class="option-item"></div>'},
_getDatasContextId:function(){return this._getPanelId()},_initPanelAction:function(){this._getPopPanel().mousedown(function(a){a.stopPropagation()}).bind("click",function(b){if(a.sdcui.classUtils.getEventClass(b)=="option-item"){var c=this.getAttribute("fieldId"),b=b.target.getAttribute("value")||"";a.sdcui.fieldUtils.execMethod(a("#"+c),"setValue",b);a.sdcui.fieldUtils.execMethod(a("#"+c),"_closePanel")}})},setValue:function(a){var c=this.getValue();this.element.find("input.value").val(a);this._isLoaded()?
(this.setText(this._getPopPanel().find('.option-item[value="'+a+'"]').text()),this._resetChildren()):this._datasLoader();this._valueChange(c,a)},_valueChange:function(b,c){if(b!=c){if(a.isFunction(window[this.options.id+"_change"]))window[this.options.id+"_change"](c,b);a.isFunction(this.options.change)&&this.options.change(c,b)}a.isFunction(this.options.afterSetValue)&&this.options.afterSetValue(c)},setWidth:function(a){a+=5;this.element.find("table").attr("width",a+"px").find("td:first").attr("width",
a-21+"px");this._getPopPanel().width(a);this.element.width(a).find(".textInput").width(a-21)},getValue:function(){return this.element.find("input.value").val()},focus:function(){this._openPanel();this.element.find("input.textInput").focus()}}));a.extend(a.sdcui.fieldSelect,{defaults:a.extend({},a.sdcui.fieldPopDefaults,{})})})(jQuery);(function(a){var b=a.sdcui.log;a.widget("sdcui.fieldText",a.extend({},a.sdcui.field,{options:a.extend({escapeSpecial:true,upperCase:true},a.sdcui.field.options),_initField:function(){},_fieldHtmls:function(){var c=[],b=this.options.width-17,f=this.options.maxLength?'maxlength="'+this.options.maxLength+'"':"";this.options.btnOptions?(this.options.btnOptions=a.extend({btncls:"searchBtn",height:21,width:22},this.options.btnOptions),c.push("<input "+f+' style="width:'+(b-this.options.btnOptions.width)+
'px;" type="text" class="textInput value"></input>'),c.push('<button type="button" style="width:'+this.options.btnOptions.width+"px;height:"+this.options.btnOptions.height+'px" class="'+this.options.btnOptions.btncls+'"></button>')):c.push("<input "+f+'style="width:'+b+'px;" type="text" class="textInput value"></input>');c.push('<div class="field-invalid"></div>');return c.join("")},setValue:function(a){this.element.find("input.value").val(a)},getValue:function(){return this.element.find("input.value").val()},
clear:function(){this.element.removeClass("validate-success").removeClass("validate-error").removeAttr("title");this.element.find("input.value").val("")},focus:function(){this.element.find("input.value").focus()},setWidth:function(a){this.options.btnOptions?(this.element.width(a).find(".textInput").width(a-this.options.btnOptions.width-4),this.element.width(a).find("button").width(this.options.btnOptions.width)):this.element.width(a).find(".textInput").width(a)},validate:function(){this.element.removeClass("validate-error").removeAttr("title");
if(!this._validateNotNull())return false;var c,b="",f=this.options.fractionLength||0,e=true;if(typeof this.options.allowNegative!=="undefined")e=this.options.allowNegative;if(this.options.expression)c=this.options.expression,b=this.options.expressionMessage;else switch(this.options.dataType){case "integer":c=this.regexps.integer(e);b="\u8bf7\u8f93\u5165\u6574\u6570\u7c7b\u578b\u503c";break;case "number":c=this.regexps.number(f);b="\u8bf7\u8f93\u5165\u6570\u503c\u7c7b\u578b\u503c\uff0c\u6700\u5927\u5c0f\u6570\u70b9\u4f4d\u6570\u4e3a"+
f;break;case "text":c=this.regexps.text;b="\u8bf7\u8f93\u5165\u7531\u6570\u5b57\u300126\u4e2a\u82f1\u6587\u5b57\u6bcd\u6216\u8005\u4e0b\u5212\u7ebf\u7ec4\u6210\u7684\u5b57\u7b26\u4e32";break;case "email":b="\u8bf7\u8f93\u5165\u90ae\u4ef6\u683c\u5f0f\u4e32";c=this.regexps.email;break;case "phone":b="\u8bf7\u8f93\u5165\u7535\u8bdd\u53f7\u7801";c=this.regexps.phone;break;case "url":b='\u8bf7\u8f93\u5165URL\uff0c\u4ee5"http://"\u5f00\u5934',c=this.regexps.url}f=a.trim(this.getValue());if(this.options.escapeSpecial&&
this._exsitSpecial(f))return this._validateError("\u542b\u6709\u7279\u6b8a\u5b57\u7b26\uff01"),false;if(f&&this.options.maxLength&&f.length>this.options.maxLength)return b="\u6700\u5927\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7"+this.options.maxLength,this._validateError(b),false;if(f&&this.options.minLength&&f.length<this.options.minLength)return b="\u6700\u5c0f\u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e"+this.options.minLength,this._validateError(b),false;return!c||!f?true:RegExp(c).test(f)?(this._validateSuccess(),
true):(this._validateError(b),false)},_exsitSpecial:function(a){return!/^[^\|"'<>]*$/.test(a)},ajaxValidate:function(){if(this.options.validateSrc){var c=this.getValue();if(!(c==null||c=="")){this.element.addClass("validating");b.info("validateSrc:"+this.options.validateSrc);var g=this.options.validateSrc;g+=g.indexOf("?")==-1?"?":"&";g+=a.sdcui.parameterUtil.propertyParameter(this.options.property,c);a.sdcui.ajaxUtil.ajax({url:g,element:this.element,success:function(a){a.message&&a.message.passed==
false?this.element.removeClass("validate-success").addClass("validate-error").attr("title",a.message.info):this.element.addClass("validate-success");this.element.removeClass("validating")},error:function(){b.error("\u6821\u9a8c\u5730\u5740\u3010"+this.url+"\u3011\u9519\u8bef:\u5730\u5740\u65e0\u6cd5\u8bbf\u95ee\uff01");this.element.removeClass("validating")}})}}},regexps:{integer:function(a){var b="^[1-9]\\d*$";a&&(b="^-?[1-9]\\d*$");return b},number:function(a){var b="^-?([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0)$";
a&&(b="^-?(0|[1-9]*)+(\\.[0-9]{1,"+a+"})?$");return b},text:"^\\w+$",email:"\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*",phone:"\\d{3}-\\d{8}|\\d{4}-\\d{7}",url:"[a-zA-z]+://[^\\s]*"},_initAction:function(){this.options.upperCase&&this.element.find("input.value").bind("keyup",function(b){b=b.keyCode?b.keyCode:b.which;b>=65&&b<=90&&a(this).val(a(this).val().toUpperCase())});this.element.find("input.value").bind("change",function(){a(this).parents(".fieldText")}).bind("keypress",function(){a(this).parents(".fieldText").removeClass("validate-error").removeClass("validate-success")});
this.options.btnOptions&&this.options.btnOptions.click&&a.isFunction(this.options.btnOptions.click)&&this.element.find("button").bind("click",this.options.bthOptions.click)}}));a.extend(a.sdcui.fieldText,{defaults:a.extend({},a.sdcui.fieldDefaults,{escapeSpecial:true})})})(jQuery);(function(a){a.widget("sdcui.fieldArea",a.extend({},a.sdcui.field,{_initField:function(){},_fieldHtmls:function(){var a=[];a.push('<textarea style="width:'+(this.options.width-17)+'px;" type="text" class="textInput value"></textarea>');a.push('<div class="field-invalid"></div>');return a.join("")},setValue:function(a){this.element.find("textarea.value").val(a)},getValue:function(){return this.element.find("textarea.value").val()},reset:function(){this.element.removeClass("validate-success").removeClass("validate-error").removeAttr("title");
this.element.find("textarea.value").val(this.options.defaultValue||"")},clear:function(){this.element.removeClass("validate-success").removeClass("validate-error").removeAttr("title");this.element.find("textarea.value").val("")},validate:function(){this.element.removeClass("validate-error").removeAttr("title");if(!this._validateNotNull())return false;var b=a.trim(this.getValue());if(b&&this.options.maxLength&&b.length>this.options.maxLength)return regMessage="\u6700\u5927\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7"+
this.options.maxLength,this._validateError(regMessage),false;if(b&&this.options.minLength&&b.length<this.options.minLength)return regMessage="\u6700\u5c0f\u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e"+this.options.minLength,this._validateError(regMessage),false}}));a.extend(a.sdcui.fieldArea,{defaults:a.extend({},a.sdcui.fieldDefaults,{})})})(jQuery);(function(a){a.widget("sdcui.fieldTree",a.extend({},a.sdcui.field,a.sdcui.fieldPop,{_initField:function(){this._initSource();var b=this.options.onlyLeaf,c=this.options.check;this.options.simple==true?this._getPopPanel().mousedown(function(c){c.stopPropagation();if(a.sdcui.classUtils.getEventClass(c)=="option-item"){c=a(c.target);if(b){var e=c.next();if(e.length){var d=c.html().split("&nbsp;").length,e=e.html().split("&nbsp;").length;if(d<e)return}}d=a(this).attr("fieldId");a("#"+d).fieldValue(c.attr("id"),
a.trim(c.text()));a(".selected",this).removeClass("selected");c.addClass("selected")}}).dblclick(function(c){if(a.sdcui.classUtils.getEventClass(c)=="option-item"){var e=a(c.target);if(b&&(c=e.next(),c.length&&(e=e.html().split("&nbsp;").length,c=c.html().split("&nbsp;").length,e<c)))return;c=a(this).attr("fieldId");a.sdcui.fieldUtils.execMethod(a("#"+c),"_closePanel")}return false}):this._getPopPanel().mousedown(function(a){a.stopPropagation()}).find("#field_tree_"+this.options.id).tree({iteratorSrc:this.options.src,
root:this.options.caption,idAttr:this.options.code,textAttr:this.options.show,iteratorParentAttr:this.options.iteratorParentAttr,autoLoad:false,select:function(f){if(!b||!a(this).hasClass("expandable")){var e=a(this).parents(".field-tree-panel:first").attr("fieldId");if(!a(this).hasClass("root")){var d=[],g=[];c?a("li.checked,li.partchecked",f).not(".root").each(function(){d.push(this.getAttribute("id"));g.push(a(">span",this).text())}):(d.push(this.getAttribute("id")),g.push(a(">span",this).text()));
a("#"+e).fieldValue(d,g)}}},dblclick:function(){if(!b||!a(this).hasClass("expandable")){var c=a(this).parents(".field-tree-panel:first").attr("fieldId");a.sdcui.fieldUtils.execMethod(a("#"+c),"_closePanel")}}});var g=a.extend({clear:function(){var c=a(this).parents(".field-tree-panel:first").attr("fieldId");a.sdcui.fieldUtils.execMethod(a("#"+c),"clear")},close:function(){var c=a(this).parents(".field-tree-panel:first").attr("fieldId");a.sdcui.fieldUtils.execMethod(a("#"+c),"_closePanel")}},this.options.buttonActions);
this.options.notNull&&(g.clear=null);a.sdcui.buttonUtils.addButtonActionListener(this._getPopPanel().find(".fieldTree-buttons"),g)},_parseRecord:function(){return""},_nullItemHtml:function(){return'<div class="option-item">\u8bf7\u9009\u62e9...</div>'},_getDatasContextId:function(){return this.options.popup?this._getPanelId():"content_"+this.options.id},_initPanelAction:function(){},_openPanel:function(){var b=this._getPopPanel();b.find("#field_tree_"+this.options.id).tree("loadIteratorRoot");this._setPanelPosition();
b.addClass("expanded");a.sdcui.popUtils.showPopBackground(1200)},setValue:function(b,c){var g=this.getValue(),f=[],e=[];a.isArray(b)?f=b:f.push(b);this.element.find("input.value").val(f.join());c==null?this.options.simple==true?(f=this._getPopPanel().find("#field_tree_"+this.options.id+" #"+b),a.trim(f.text())):this.options.check&&f.length?this._getPopPanel().find("#field_tree_"+this.options.id).tree("checkedTreeNodes",f):(f=this._getPopPanel().find("#field_tree_"+this.options.id+" #"+b),f.length&&
f.find(">span").text()):a.isArray(c)?e=c:e.push(c);g!=b&&this._resetChildren();this.element.find("input.textInput").val(e.join())},_valueChange:function(b,c){if(b!=c&&a.isFunction(window[this.options.id+"_change"]))window[this.options.id+"_change"](c,b)},validate:function(){this.element.removeClass("validate-error").removeAttr("title");if(!this._validateNotNull())return false},getValue:function(){var a=this.element.find("input.value").val();return a?a.split(","):null},clear:function(){this.element.find("input.textInput,input.value").val("");
this.options.check?this._getPopPanel().find("#field_tree_"+this.options.id).tree("clearCheckedTreeNodes"):this._getPopPanel().find("#field_tree_"+this.options.id+" .selected").removeClass("selected")}}));a.extend(a.sdcui.fieldTree,{defaults:a.extend({},a.sdcui.fieldPopDefaults,{popup:true})})})(jQuery);(function(a){function b(c){var b=c||window.event,d=[].slice.call(arguments,1),g=0,j=0,k=0,c=a.event.fix(b);c.type="mousewheel";b.wheelDelta&&(g=b.wheelDelta/120);b.detail&&(g=-b.detail/3);k=g;b.axis!==void 0&&b.axis===b.HORIZONTAL_AXIS&&(k=0,j=-1*g);b.wheelDeltaY!==void 0&&(k=b.wheelDeltaY/120);b.wheelDeltaX!==void 0&&(j=-1*b.wheelDeltaX/120);d.unshift(c,g,j,k);return(a.event.dispatch||a.event.handle).apply(this,d)}var c=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var g=c.length;g;)a.event.fixHooks[c[--g]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],b,false);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],b,false);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
(function(a){a.widget("sdcui.borderLayout",{options:{initHtml:true},_create:function(){this._defaultHtmls();this._initAction();this._autoResize()},_autoResize:function(){var b=a(window).width(),c=a(window).height(),g=a(".panel-center:first"),f=this.element.find(">.panel-north"),e=this.element.find(">.panel-south"),d=this.element.find(".panel-west:first"),i=d.width(),f=f.outerHeight(),e=e.outerHeight();contentHeight=c-f-e-5;g.css({width:b-i,height:contentHeight});d.height(contentHeight+5)},_defaultHtmls:function(){},
_initAction:function(){var b=this;a(window).bind("resize",function(){var c=a(window).width()+":"+a(window).height();if(c!==window.lastResize)window.lastResize=c,b._autoResize(),a(".layout-resize-handle").trigger("layout.resize")}).bind("mousedown",function(){a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor()});a("body",this.element).scroll(function(){a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor()});a("body").mousewheel(function(){a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor()})},
destroy:function(){a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);(function(a){function b(a){this.value="";this.pos=0;this.string=a;this.len=a.length;this.fmts="yyyy,yy,y,MMMM,MMM,NNN,MM,M,dd,d,EEEE,EE,E,hh,h,HH,H,KK,K,kk,k,mm,m,ss,s,a".split(",");this.parse_string=function(a,b){for(var c=0;c<a.length;++c){var d=a[c].length,i=b?a[c]:a[c].toLowerCase();if(this.len>=this.pos+d&&(b?this.string.substr(this.pos,d):this.string.substr(this.pos,d).toLowerCase())==i)return this.value=this.string.substr(this.pos,d),this.pos+=d,c}return-1};this.parse_char=function(){return this.len>=
this.pos+1?(this.value=this.string.substr(this.pos,1),this.pos+=1,0):-1};this.parse_space=function(){for(;this.string.charAt(this.pos)==" "||this.string.charAt(this.pos)=="\t";)++this.pos;return 0};this.parse_number=function(a,c,b){if(this.len>=this.pos+a){for(var d=0;d<a;++d)if(parseInt(this.string.charAt(this.pos+d),10)!=this.string.charAt(this.pos+d))return-1;this.value=this.string.substr(this.pos,a);d=parseInt(this.value,10);if(d>=c&&d<=b)return this.pos+=a,d}return-1};this.parse_format=function(){return this.parse_string(this.fmts,
true)==-1?this.parse_char():0}}a.sdcui.dateUtil={dateToStr:function(a,b){return!a?"":a.igFormat(b)},strToDate:function(a,b){if(b==null||a==null)throw"Invalid arguments";return(new Date).igParse(b,a)}};a.widget("sdcui.datepicker",{_create:function(){this.element.addClass("youi-datepicker");this.options.showIcon&&a('<a href="#" class="youi-datepicker-icon"></a>').insertAfter(this.element).bind("click",function(){a(this).prev().datepicker("openDatepickerPanel")}).bind("mousedown",function(a){a.stopPropagation()});
this._initAction()},_initAction:function(){var b=this;a(document).bind("mousedown.datepicker",function(){b.closeDatepickerPanel()});this.element.keydown(function(){a(this).datepicker("doKeyDown")}).keyup(function(){a(this).datepicker("doKeyDown")});this.element.bind("click",function(){a(this).datepicker("openDatepickerPanel")}).bind("mousedown",function(a){a.stopPropagation()})},doKeyDown:function(){var b=this.element.val();if(b=a.sdcui.dateUtil.strToDate(b,this.options.format))year=b.getFullYear(),
month=b.getMonth(),this._getDatepickerPanel().datepickerPanel("goDate",year,month)},openDatepickerPanel:function(){var b=this.element.val(),b=a.sdcui.dateUtil.strToDate(b,this.options.format),g={},f=this._getDatepickerPanel();g.left=this.element.offset().left;g.top=this.element.offset().top+this.element.outerHeight();g=this._checkOffset(f,g);f.datepickerPanel("open",b,this.element).css({left:g.left,top:g.top})},_checkOffset:function(b,g){var f=b.outerWidth(),e=b.outerHeight();this.element.outerWidth();
var d=this.element.outerHeight(),i=document.documentElement.clientWidth+a(document).scrollLeft(),j=document.documentElement.clientHeight+a(document).scrollTop();g.left-=Math.min(g.left,g.left+f>i&&i>f?Math.abs(g.left+f-i):0);g.top-=Math.min(g.top,g.top+e>j&&j>e?Math.abs(e+d):0);return g},closeDatepickerPanel:function(){this._getDatepickerPanel().datepickerPanel("close")},_getDatepickerPanel:function(){var b=a("#youi-datepicker-panel");b.length==0&&(b=a('<div class="datepicker-pop datepicker-hide" id="youi-datepicker-panel"></div>').appendTo(a("body",
document)));b.datepickerPanel({bind:this.element,format:this.options.format,onSelect:this.options.select});return b}});a.extend(a.sdcui.datepicker,{version:"1.0.0",defaults:{format:"yyyy-MM-dd",showIcon:false}});a.widget("sdcui.datepickerPanel",{currentDate:null,options:{format:"yyyy-MM-dd",yearRange:"c-10:c+10"},_create:function(){this.element.addClass("youi-datepicker-panel");this.currentDate=new Date;this.selectedDate=new Date;this._defaultHtmls();this._initAction()},_defaultHtmls:function(){var a=
new Date,b=a.getFullYear(),a=a.getMonth(),f=[];f.push('<div class="datepicker-header"><table width="100%" cellpadding="0" cellspacing="0"><tr><td><a class="listener-prevYear" href="#" title="\u4e0a\u4e00\u5e74"><<</a><a class="listener-prevMonth" href="#" title="\u4e0a\u4e00\u6708"><</a></td><td align="center" class="datepicker-dateInfo">'+this._getYearMonthStr(b,a)+'</td><td align="right"><a href="#" class="listener-nextMonth" title="\u4e0b\u4e00\u6708">></a><a href="#" class="listener-nextYear" title="\u4e0b\u4e00\u5e74">>></a></td></tr></table></div>');
f.push('<div class="datepicker-content">');f.push(this._generateContentHtml(b,a));f.push("</div>");f.push('<div class="datepicker-footer">');f.push('<table width="100%" cellpadding="0" cellspacing="0" height="22px">');f.push('<tr><td><input type="text" size="2"  class="datepicker-time HH">\u65f6</input></td>');f.push('<td><input type="text" size="2" class="datepicker-time MI">\u5206</input></td>');f.push('<td><input type="text" size="2"  class="datepicker-time SS">\u79d2</input></td>');f.push('<td  valign="bottom" style="padding-bottom:2px;"><a href="#" class="listener-today aButton">\u4eca\u5929</a>');
f.push('<a href="#" class="listener-clear aButton">\u6e05\u9664</a>');f.push('<a href="#" class="listener-max aButton">\u6700\u5927</a></td><td></td></tr></table>');f.push("</div>");this.element.html(f.join(""))},_initAction:function(){this.element.bind("click",function(b){var g=b.target.className;g&&(g=g.split(" ")[0]);switch(g){case "listener-prevMonth":a(this).datepickerPanel("prevMonth");break;case "listener-nextMonth":a(this).datepickerPanel("nextMonth");break;case "listener-prevYear":a(this).datepickerPanel("prevYear");
break;case "listener-nextYear":a(this).datepickerPanel("nextYear");break;case "datapicker-days":a(this).datepickerPanel("selectDate",a(b.target).text());break;case "listener-today":b=new Date;a(this).datepickerPanel("goDate",b.getFullYear(),b.getMonth()).datepickerPanel("selectDate",b);break;case "listener-clear":a(this).datepickerPanel("clear");break;case "listener-max":b=new Date(9999,11,31),a(this).datepickerPanel("goDate",b.getFullYear(),b.getMonth()).datepickerPanel("selectDate",b)}return false}).bind("mousedown",
function(a){a.stopPropagation()});this.element.find(".datepicker-time").bind("keydown",function(b){b.keyCode=="13"&&(b=a(this).parents(".youi-datepicker-panel:first"),b.datepickerPanel("selectDate",a(".datapicker-days.selected",b).text()))})},_generateContentHtml:function(a,b){var f=this._getDaysInMonth(a,b),e=this._getFirstDayOfMonth(a,b),e=e==7?"-1":e,d,i=['<table width="100%" border="0" cellpadding="0" cellspacing="1"><tbody>'];i.push("<tr><th>\u65e5</th><th>\u4e00</th><th>\u4e8c</th><th>\u4e09</th><th>\u56db</th><th>\u4e94</th><th>\u516d</th></tr>");
i.push("<tr>");for(var j,k=0;k<7;k++)j=k-e+1,i.push("<td>"),k>=e&&(i.push('<a id="'+j+'" class="'+this._getDateTdClass(a,b,j,f)+'">'+j+"</a>"),k==6&&(d=j)),i.push("</td>");i.push("</tr>");e=Math.ceil((f-d)/7);for(k=0;k<e;k++){i.push("<tr>");for(j=0;j<7;j++)i.push("<td>"),++d<=f&&i.push('<a id="'+d+'" class="'+this._getDateTdClass(a,b,d,f)+'">'+d+"</a>"),i.push("</td>");i.push("</tr>")}i.push("</tbody></table>");return i.join("")},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},
_getDaysInMonth:function(a,b){return 32-(new Date(a,b,32)).getDate()},_getYearMonthStr:function(a,b){var f=[];f.push("<select onchange=\"$('#youi-datepicker-panel').datepickerPanel('changeYearOrMonth')\" class=\"datepicker-time yyyy\" >");f.push(this._getYearOptions(a));f.push("</select>\u5e74");f.push("<select onchange=\"$('#youi-datepicker-panel').datepickerPanel('changeYearOrMonth')\" class=\"datepicker-time MM\" >");for(var e=1;e<13;e++)f.push('<option value="'+(e-1)+'"'+(e==b+1?' selected="selected"':
"")+">"+e+"</option>");f.push("</select>\u6708");return f.join("")},_getYearOptions:function(a){var b=[];this.options.yearRange.split(":");(new Date).getFullYear();for(var f=parseInt(a)-10,e=parseInt(a)+10;f<=e;f++)b.push('<option value="'+f+'"'+(f==a?' selected="selected"':"")+">"+f+"</option>");return b.join("")},_getDateTdClass:function(a,b,f,e){var d=[];f>0&&f<=e&&d.push("datapicker-days");var e=this.selectedDate.getFullYear(),i=this.selectedDate.getMonth(),j=this.selectedDate.getDate();e==a&&
i==b&&f==j&&d.push("selected");f<10&&d.push("small");e=new Date;e.getFullYear()==a&&e.getMonth()==b&&f==e.getDate()&&d.push("today");return d.join(" ")},_selectDate:function(b){if(typeof b=="object"&&b.getTime())this.currentDate=b,b=b.getDate();var g=this.currentDate.getFullYear(),f=this.currentDate.getMonth(),g=new Date(g,f,b),f=a("input.datepicker-time.HH",this.element).val(),e=a("input.datepicker-time.MI",this.element).val(),d=a("input.datepicker-time.SS",this.element).val();isNaN(f)||(f=parseInt(f),
0<f&&f<24||(f=0));isNaN(e)||(e=parseInt(e),e>0&&e<60||(e=0));isNaN(d)||(d=parseInt(d),d>0&&d<60||(d=0));g.setHours(f);g.setMinutes(e);g.setSeconds(d);f=a.sdcui.dateUtil.dateToStr(g,this.options.format);this.element.find(".datepicker-content .selected").removeClass("selected");this.element.find(".datepicker-content #"+b).addClass("selected");this.options.bind&&(a(this.options.bind).val(f),this.close());if(a.isFunction(this.options.onSelect))this.options.onSelect(g,f)},selectDate:function(a){this._selectDate(a)},
nextYear:function(){var a=this.getDate(),b=a.getFullYear(),a=a.getMonth();this.goDate(b+1,a)},changeYearOrMonth:function(){this.goDate(this.element.find("select.datepicker-time.yyyy").val(),this.element.find("select.datepicker-time.MM").val())},prevYear:function(){var a=this.getDate(),b=a.getFullYear(),a=a.getMonth();this.goDate(b-1,a)},prevMonth:function(){var a=this.getDate(),b=a.getFullYear(),a=a.getMonth();a--;a==-1&&(a=11,b--);this.goDate(b,a)},nextMonth:function(){var a=this.getDate(),b=a.getFullYear(),
a=a.getMonth();a++;a==12&&(a=0,b++);this.goDate(b,a)},getDate:function(){return this.currentDate},goDate:function(a,b){this.updateYearOptions(a);this.element.find(".datepicker-dateInfo select.MM").val(b);this.element.find(".datepicker-content").empty().append(this._generateContentHtml(a,b));this.currentDate=new Date(a,b,1)},updateYearOptions:function(a){this.element.find(".datepicker-dateInfo select.yyyy option").remove();a=this._getYearOptions(a);this.element.find(".datepicker-dateInfo select.yyyy").html(a)},
open:function(b,g){g&&(this.options.bind=g);b||(b=new Date);this.selectedDate=b;this.goDate(b.getFullYear(),b.getMonth(),b.getDate());this.element.removeClass("datepicker-hide");a("input.datepicker-time.HH",this.element).val(b.getHours());a("input.datepicker-time.MI",this.element).val(b.getMinutes());a("input.datepicker-time.SS",this.element).val(b.getSeconds());a.sdcui.popUtils.showPopBackground()},close:function(){this.element.addClass("datepicker-hide");a.sdcui.popUtils.hidePopBackground()},clear:function(){this.options.bind.val("");
this.element.find(".selected").removeClass("selected")}});a.extend(a.sdcui.datepickerPanel,{version:"1.0.0",defaults:{format:"yyyy-MM-dd",yearRange:"c-10:c+10"}});Date.prototype.igSetLocale=function(a,b,f,e,d){this.mnths=a===null?this.en_mnths:a.split(",");this.months=b===null?this.en_months:b.split(",");this.dys=f===null?this.en_dys:f.split(",");this.days=e===null?this.en_days:e.split(",");this.ampms=d===null?this.en_ampms:d.split(",")};Date.prototype.itoa=function(a,b){for(var f=""+a,e=f.length,
d=0;d<b-e;++d)f="0"+f;e>b&&(f=f.substr(e-b));return f};Date.prototype.igFormat=function(a){for(var g=this.getFullYear(),f=this.getMonth(),e=this.getDate(),d=this.getDay(),i=this.getHours(),j=this.getMinutes(),k=this.getSeconds(),a=new b(a),h="";a.parse_format()!=-1;)switch(a.value){case "yyyy":h+=this.itoa(g,4);break;case "yy":h+=this.itoa(g,2);break;case "y":h+=this.itoa(g,4);break;case "MMMM":h+=this.months[f];break;case "MMM":h+=this.mnths[f];break;case "NNN":h+=this.mnths[f];break;case "MM":h+=
this.itoa(1+f,2);break;case "M":h+=1+f;break;case "dd":h+=this.itoa(e,2);break;case "d":h+=e;break;case "EEEE":case "EE":h+=this.days[d];break;case "E":h+=this.dys[d];break;case "hh":h+=this.itoa(i%12===0?12:i%12,2);break;case "h":h+=i%12===0?12:i%12;break;case "HH":h+=this.itoa(i,2);break;case "H":h+=i;break;case "KK":h+=this.itoa(i%12,2);break;case "K":h+=i%12;break;case "kk":h+=this.itoa(i===0?24:i,2);break;case "k":h+=i===0?24:i;break;case "mm":h+=this.itoa(j,2);break;case "m":h+=j;break;case "ss":h+=
this.itoa(k,2);break;case "s":h+=k;break;case "a":h+=i<12?this.ampms[0]:this.ampms[1];break;case "W":h+=this.getWeekInMonth(e);break;case "w":h+=this.getWeekInYear(this);break;default:h+=a.value}return h};Date.prototype.getWeekInMonth=function(a){return Math.ceil(a/7)};Date.prototype.getWeekInYear=function(a){var b=new Date(a.getFullYear(),0,1);return Math.ceil(((a-b)/864E5+b.getDay())/7)};Date.prototype.igParse=function(a,g){for(var f=new b(a),e=new b(g),d=-1,i=-1,j=-1,k=-1,h=-1,l=-1,n=-1,o=0;f.parse_format()!=
-1;)switch(f.value){case "yyyy":d=e.parse_number(4,0,9999);if(d<0)return null;break;case "yy":d=e.parse_number(2,0,99);if(d<0)return null;d+=d>50?1900:2E3;break;case "y":d=e.parse_number(4,0,9999);d<0&&(d=e.parse_number(2,0,99),d>=0&&(d+=2E3));if(d<0)return null;break;case "MMM":case "MMMM":case "NNN":i=e.parse_string(this.mnths,false);i<0&&(i=e.parse_string(this.months,false));if(i<0)return null;break;case "MM":i=e.parse_number(2,1,12);if(i<0)return null;--i;break;case "M":i=e.parse_number(2,1,12);
i<0&&(i=e.parse_number(1,1,12));if(i<0)return null;--i;break;case "dd":j=e.parse_number(2,1,31);if(j<0)return null;break;case "d":j=e.parse_number(2,1,31);j<0&&(j=e.parse_number(1,1,31));if(j<0)return null;break;case "EEEE":case "EE":k=e.parse_string(this.days,false);if(k<0)return null;break;case "E":k=e.parse_string(this.dys,false);if(k<0)return null;break;case "hh":h=e.parse_number(2,1,12);if(h<0)return null;h==12&&(h=0);break;case "h":h=e.parse_number(2,1,12);h<0&&(h=e.parse_number(1,1,12));if(h<
0)return null;h==12&&(h=0);break;case "HH":h=e.parse_number(2,0,23);if(h<0)return null;break;case "H":h=e.parse_number(2,0,23);h<0&&(h=e.parse_number(1,0,23));if(h<0)return null;break;case "KK":h=e.parse_number(2,0,11);if(h<0)return null;break;case "K":h=e.parse_number(2,0,11);h<0&&(h=e.parse_number(1,0,11));if(h<0)return null;break;case "kk":h=e.parse_number(2,1,24);if(h<0)return null;h==24&&(h=0);break;case "k":h=e.parse_number(2,1,24);h<0&&(h=e.parse_number(1,1,24));if(h<0)return null;h==24&&(h=
0);break;case "mm":l=e.parse_number(2,0,59);if(l<0)return null;break;case "m":l=e.parse_number(2,0,59);l<0&&(l=e.parse_number(1,0,59));if(l<0)return null;break;case "ss":n=e.parse_number(2,0,59);if(n<0)return null;break;case "s":n=e.parse_number(2,0,59);n<0&&(n=e.parse_number(1,0,59));if(n<0)return null;break;case "a":o=e.parse_string(this.ampms,false);if(o<0)return null;break;case " ":e.parse_space();break;case "w":break;case "W":break;default:if(e.parse_char()<0)return null;if(f.value!=e.value)return null}d!=
-1&&this.setFullYear(d);i!=-1?(j==-1&&(previousDate=this.getDate()),this.setDate(1),this.setMonth(i),j!=-1?this.setDate(j):this.setDate(previousDate)):j!=-1&&this.setDate(j);h!=-1&&this.setHours(o===0?h:h+12);l!=-1&&this.setMinutes(l);n!=-1&&this.setSeconds(n);return k!=-1&&this.getDay()!=k?null:this};Date.prototype.en_mnths="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",");Date.prototype.en_months="January,February,March,April,May,June,July,August,September,October,November,December".split(",");
Date.prototype.en_dys="Mon,Tue,Wed,Thu,Fri,Sat,Sun".split(",");Date.prototype.en_days="Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday".split(",");Date.prototype.en_ampms=["am","pm"];Date.prototype.mnths=this.en_mnths;Date.prototype.months=this.en_months;Date.prototype.dys=this.en_dys;Date.prototype.days=this.en_days;Date.prototype.ampms=this.en_ampms})(jQuery);(function(a){a.ui.dialog||(a.widget("sdcui.dialog",a.extend({},a.ui.mouse,{options:{position:"center",width:600,zIndex:1E3},_create:function(){this.element.addClass("youi-dialog");this.originalTitle=this.element.attr("title");this.dialogId=a.sdcui.dialog.getId(this.element);this._defaultHtmls();a("#"+this.dialogId+" .youi-dialog-content").append(this.element);this._initAction();a("#"+this.dialogId).width(this.options.width)},_defaultHtmls:function(){var b=[],c=this.options.title||this.originalTitle||
"&nbsp;";b.push('<div id="'+this.dialogId+'" style="z-index:'+this.options.zIndex+'" class="youi-dialog-container">');b.push('<div class="youi-dialog-titlebar">');b.push("\t<div><div><a></a><a>"+c+"</a></div></div>");this.options.hideCloseIcon!=true&&b.push('\t<a title="\u5173\u95ed" class="youi-dialog-titlebar-close"></a>');b.push("</div>");b.push('<div class="youi-dialog-ml"><div class="youi-dialog-mr"><div class="youi-dialog-content"></div></div></div>');b.push('<div class="youi-dialog-bl"><div class="youi-dialog-br"><div class="youi-dialog-buttonpane');
this.options.buttons&&this.options.buttons.length>0?(b.push(' buttons">'),b.push(this._buttonsHtml())):b.push('">');b.push("</div></div></div>");b.push('<div class="dragging-dialog-helper"></div>');b.push("</div>");a("body",document).append(b.join(""))},_buttonsHtml:function(){var b=['<table border="0" cellpadding="0" align="center"><tr>'];a(this.options.buttons).each(function(){b.push('<td valign="top">');b.push(a.sdcui.buttonHtmls(this.name,this.caption,["dialog-button"],this.caption));b.push("</td>")});
b.push("</tr></table>");return b.join("")},_initAction:function(){var b=this;a("#"+this.dialogId+" .youi-dialog-titlebar").mousable({delay:100,start:function(c){a(".dragging-dialog-helper",this.parentNode).addClass("youi-dragging").css({width:this.parentNode.offsetWidth,height:this.parentNode.offsetHeight,left:0,top:0});b.originalOffsetLeft=c.pageX-this.parentNode.offsetLeft;b.originalOffsetTop=c.pageY-this.parentNode.offsetTop;a(this.parentNode).disableSelection();return true},drag:function(c){var g=
c.pageX-this.parentNode.offsetLeft-b.originalOffsetLeft,c=c.pageY-this.parentNode.offsetTop-b.originalOffsetTop;a(".dragging-dialog-helper",this.parentNode).css({left:g,top:c})},stop:function(){var c=a(".dragging-dialog-helper",this.parentNode),g=c.offset();if(g.top<0)g.top=0;a(this.parentNode).css(g);c.removeClass("youi-dragging");b.originalOffsetLeft=null;b.originalOffsetTop=null;a(this.parentNode).enableSelection()}});a("#"+this.dialogId+" .youi-dialog-titlebar-close").bind("mouseover",function(){a(this).addClass("over")}).bind("mouseout",
function(){a(this).removeClass("over")}).bind("click",function(){b.close()});a("#"+this.dialogId+" .youi-dialog-buttonpane button").bind("click",function(){var a=this.getAttribute("id");b._execButton(a)})},_execButton:function(a){var c=this.options.buttons;if(c&&c.length)for(var g=0;g<c.length;g++)if(c[g].name==a){c[g].action();break}},open:function(b,c){var g=this.options,f=a("#"+this.dialogId);this.overlay=g.modal?new a.sdcui.dialog.overlay(this):null;this._position(this.options.position);b&&a(".youi-dialog-titlebar a:first",
f).text(b);c&&(f.css("zIndex",c),this.overlay.$el.css("zIndex",c-1));f.show();a.ui.hasScroll(a("body",document))||a("body",document).addClass("dialog-open");this.element.find(".dialog-open-handle").trigger("dialog.open")},_position:function(b){var c=a("#"+this.dialogId),g=a(window),f=a(document),e=f.scrollTop(),f=f.scrollLeft(),d=e;a.inArray(b,["center","top","right","bottom","left"])>=0&&(b=[b=="right"||b=="left"?b:"center",b=="top"||b=="bottom"?b:"middle"]);b.constructor!=Array&&(b=["center","middle"]);
if(b[0].constructor==Number)f+=b[0];else switch(b[0]){case "left":f+=0;break;case "right":f+=g.width()-c.outerWidth();break;default:case "center":f+=(g.width()-c.outerWidth())/2}if(b[1].constructor==Number)e+=b[1];else switch(b[1]){case "top":e+=0;break;case "bottom":e+=g.height()-c.outerHeight();break;default:case "middle":e+=(g.height()-c.outerHeight())/2}e=Math.max(e,d);c.css({top:e,left:f})},close:function(){if(!a.isFunction(this.options.close)||this.options.close.apply(this.element[0]))this.overlay&&
this.overlay.destroy(),a("#"+this.dialogId).hide(),a("body",document).removeClass("dialog-open")},destroy:function(){this.overlay&&this.overlay.destroy();var b=a("#"+this.dialogId);this.element.unbind(".dialog").removeData("dialog").removeClass("youi-dialog-content").hide().appendTo("body");b.remove();this.originalTitle&&this.element.attr("title",this.originalTitle)}})),a.extend(a.sdcui.dialog,{version:"1.0.0",uuid:0,getId:function(a){return"youi-dialog-"+(a.attr("id")||++this.uuid)},overlay:function(b){this.$el=
a.sdcui.dialog.overlay.create(b)}}),a.extend(a.sdcui.dialog.overlay,{instances:[],maxZ:0,create:function(b){var c=a("<div></div>").appendTo(document.body).addClass("ui-widget-overlay").css({width:this.width(),height:this.height()}).css("zIndex",b.options.zIndex-1);b.options.bgiframe&&a.fn.bgiframe&&c.bgiframe();this.instances.push(c);return c},destroy:function(b){this.instances.splice(a.inArray(this.instances,b),1);b.remove();var c=0;a.each(this.instances,function(){c=Math.max(c,this.css("z-index"))});
this.maxZ=c},height:function(){if(a.browser.msie&&a.browser.version<7){var b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return b<c?a(window).height()+"px":b+"px"}else return a(document).height()+"px"},width:function(){if(a.browser.msie&&a.browser.version<7){var b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);
return b<c?a(window).width()+"px":b+"px"}else return a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.sdcui.dialog.overlay.instances,function(){b=b.add(this)});b.css({width:0,height:0}).css({width:a.sdcui.dialog.overlay.width(),height:a.sdcui.dialog.overlay.height()})}}),a.extend(a.sdcui.dialog.overlay.prototype,{destroy:function(){a.sdcui.dialog.overlay.destroy(this.$el)}}),a.extend(a.sdcui.msgbox,{version:"1.0.0",defaults:{title:"\u6d88\u606f\u63d0\u793a\u6846",confirmable:false,
submitArgs:["arg1"],submit:function(a){alert("\u786e\u5b9a"+a)}}}))})(jQuery);(function(a){function b(c,e){var d={},i,g,k;for(k in c)g=c[k],i=(e?e+"_":"")+k,g==null||g==""||(typeof g=="string"||typeof g=="number"||g.length?d[i]=g:typeof g=="object"&&a.extend(d,b(g,(e?e+"_":"")+k)));return d}function c(b,c){function d(){if(!v++){o.detachEvent?o.detachEvent("onload",d):o.removeEventListener("load",d,false);var b=true;try{if(r)throw"timeout";var h,f;f=o.contentWindow?o.contentWindow.document:o.contentDocument?o.contentDocument:o.document;if(!(k.dataType=="xml"||f.XMLDocument||
a.isXMLDoc(f))&&(f.body==null||f.body.innerHTML=="")){if(--q){v=0;setTimeout(d,100);return}g.info("Could not access iframe DOM after 50 tries.");return}p.responseText=f.body?f.body.innerHTML:null;p.responseXML=f.XMLDocument?f.XMLDocument:f;p.getResponseHeader=function(a){return{"content-type":k.dataType}[a]};if(k.dataType=="json"||k.dataType=="script"){var l=f.getElementsByTagName("textarea")[0];if(l)p.responseText=l.value;else{var j=f.getElementsByTagName("pre")[0];if(j)p.responseText=j.innerHTML}}else if(k.dataType==
"xml"&&!p.responseXML&&p.responseText!=null)p.responseXML=i(p.responseText);h=jQuery.parseJSON(p.responseText)}catch(m){b=false,k.error.apply(k,[h.errorMsg])}if(b){if(h==null)return;if(h.hasError){a.sdcui.messageUtil.showError(h.errorMsg);k.error.apply(c,[h.errorMsg]);return}h.result&&h.result.message&&a.sdcui.messageUtil.showMessage(h.result.message);k.success(h,"success");t&&a.event.trigger("ajaxSuccess",[p,k])}t&&a.event.trigger("ajaxComplete",[p,k]);t&&!--a.active&&a.event.trigger("ajaxStop");
k.complete&&k.complete(p,b?"success":"error");setTimeout(function(){n.remove();p.responseXML=null},100)}}function i(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&b.documentElement.tagName!="parsererror"?b:null}var j=b[0];if(a(":input[name=submit]",j).length)alert('Error: Form elements must not be named "submit".');else{var k=a.extend({},a.ajaxSettings,c),h=a.extend(true,
{},a.extend(true,{},a.ajaxSettings),k),l="jqFormIO"+(new Date).getTime(),n=a('<iframe id="'+l+'" name="'+l+'" src="'+k.iframeSrc+'" />'),o=n[0];n.css({position:"absolute",top:"-1000px",left:"-1000px"});var p={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;n.attr("src",k.iframeSrc)}},t=k.global;t&&!a.active++&&a.event.trigger("ajaxStart");t&&a.event.trigger("ajaxSend",
[p,k]);if(h.beforeSend&&h.beforeSend(p,h)===false)h.global&&a.active--;else if(!p.aborted){var v=0,r=0;if(h=j.clk){var m=h.name;if(m&&!h.disabled&&(c.extraData=c.extraData||{},c.extraData[m]=h.value,h.type=="image"))c.extraData[name+".x"]=j.clk_x,c.extraData[name+".y"]=j.clk_y}setTimeout(function(){var h=b.attr("target"),i=b.attr("action");j.setAttribute("target",l);j.getAttribute("method")!="POST"&&j.setAttribute("method","POST");j.getAttribute("action")!=k.url&&j.setAttribute("action",k.url);c.skipEncodingOverride||
b.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});k.timeout&&setTimeout(function(){r=true;d()},k.timeout);var g=[];try{if(c.extraData)for(var p in c.extraData)g.push(a('<input type="hidden" name="'+p+'" value="'+c.extraData[p]+'" />').appendTo(j)[0]);n.appendTo("body");o.attachEvent?o.attachEvent("onload",d):o.addEventListener("load",d,false);j.submit()}finally{j.setAttribute("action",i),h?j.setAttribute("target",h):b.removeAttr("target"),a(g).remove()}},10);var q=50}}}var g=
a.sdcui.log;a.widget("sdcui.form",{_create:function(){this._initAction()},_initAction:function(){var b=a.extend({submit:function(){a(this).parents("form:first").form("submit")},reset:function(){a(this).parents("form:first").form("reset")},clear:function(){a(this).parents("form:first").form("clear")},close:function(){a(this).parents("form:first").form("close")},remove:function(){a(this).parents("form:first").form("remove")}},this.options.buttonActions);a.sdcui.buttonUtils.addButtonActionListener(this.element.find(">.form-buttons"),
b);this.element.bind("submit.form",function(){a(this).form("submit");return false})},getFormRecord:function(){var b={};this.element.find(".youi-field").each(function(){var c=this.getAttribute("property"),d;c&&(d=a(this).fieldValue())&&(b[c]=encodeURIComponent(d))});return b},getFieldValues:function(){var b=[];this.element.find(".youi-field").each(function(){var c=this.getAttribute("property"),d;c&&((d=a(this).fieldValue())&&(typeof d=="string"?b.push({property:c,value:d}):d&&d.length?typeof d[0]==
"object"?a(d).each(function(a){for(var d in this)b.push({property:c+"["+a+"]."+d,value:this[d]})}):a(d).each(function(a){b.push({property:c+"["+a+"]",value:this})}):a.type(d)==="object"&&a.each(d,function(d,g){a.each(g,function(g,h){a.each(h,function(a,h){b.push({property:c+"_"+d+"["+g+"]."+a,value:h})})})})),d=null)});return b},fieldValue:function(a,b){return this.element.find(".youi-field[property="+a+"]").fieldValue(b)},fieldDefaultValue:function(a,b){var d=this.element.find('.youi-field[property="'+
a+'"]');d.fieldDefaultValue(b);d.fieldReset()},fillRecord:function(b){this.record=b;var c=","+(this.options.idKeys||"")+",";this.element.find(".youi-field").each(function(){var d=this.getAttribute("property"),i=a("input.textInput",this).attr("showProperty"),j=a.sdcui.recordUtils.getPropertyValue(b,d);if(j!=null&&j.length!=0)try{var k=!i?null:a.sdcui.recordUtils.getPropertyValue(b,i),h=a(this);h.fieldValue(j,k);c.indexOf(","+d+",")!=-1&&h.fieldDisabled()}catch(l){g.info("\u8bbe\u7f6e\u503c\u5f02\u5e38\uff1a"+
l)}})},_isRecordChange:function(){if(this.avoidRecordChange==true)return false;var c=b(this.record),e=false;this.element.find(".youi-field").each(function(){var b=this.getAttribute("property")||" ",b=c[b.replace(/\./g,"_")],i=a(this).fieldValue();if(!b&&!i)return false;!e&&b!=i&&(e=true)});return e},noRecordChange:function(){this.noRecordChange=true},find:function(b,c){this.element.find(".youi-field").fieldReset();a.sdcui.ajaxUtil.ajax({url:b,widgetId:this.options.id,afterFind:c,success:function(b){if(b&&
b.result)b=b.result,a("#"+this.widgetId).form("fillRecord",b),a.isFunction(this.afterFind)&&this.afterFind.apply(this,[b])}})},validate:function(){this.element.find(".youi-field").fieldValidate();return this.element.find(".youi-field.validating,.youi-field.validate-error,.edited.validate-error").length==0?true:false},diabledSubmitButton:function(){this.element.find("#button-submit").addClass("disabled")},activeSubmitButton:function(){this.avoidRecordChange=false;this.element.find("#button-submit").removeClass("disabled")},
submit:function(b,e){this.diabledSubmitButton();if(this.validate())if(a.isFunction(window[this.options.id+"_beforeSubmit"])&&!window[this.options.id+"_beforeSubmit"].apply(this.element[0]))this.activeSubmitButton();else{this.avoidRecordChange=true;var d=this.getFieldValues(),i=[];e&&i.push("method="+e);this.element.hasClass("operant-add")?i.push("operant=1"):i.push("operant=2");a.isArray(b)&&(d=d.concat(b));for(var g=0;g<d.length;g++)i.push(a.sdcui.parameterUtils.propertyParameter(d[g].property,d[g].value));
this.element.find("input.extra-field").each(function(){i.push(this.getAttribute("name")+"="+this.value)});if(d=a.trim(this.element.attr("action"))){var d=(d=(d.match(/^([^#]+)/)||[])[1])||window.location.href||"",k=false;a(".youi-field input:file",this.element).each(function(){this.value&&(k=true)});var h=this.options.id,g=i.join("&"),d={url:d,data:g,dataType:"json",id:this.options.id,success:function(b){if(a.isFunction(window[this.id+"_afterSubmit"]))window[this.id+"_afterSubmit"](b);a("#"+this.id).form("activeSubmitButton");
a("#"+this.id).find(".youi-field").trigger("form.submit",[])},domainValidator:function(b){a.sdcui.messageUtil.showMessage(a.sdcui.resourceUtils.get("form.invalid",b.message.info))},error:function(){a("#"+h).form("activeSubmitButton");a.sdcui.log.error("\u5730\u5740\u3010"+this.url+"\u3011\u8bbf\u95ee\u5f02\u5e38")}};k?(d=a.extend({},d,{iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",extraData:i.join("&")}),c(this.element,d)):a.sdcui.ajaxUtil.ajax(d)}else if(a.isFunction(window[this.options.id+
"_afterSubmit"]))window[this.options.id+"_afterSubmit"]({record:this.getFormRecord()})}else{var l=[];this.element.find(".youi-field.validating,.youi-field.validate-error,.edited.validate-error").each(function(){this.title&&l.push(this.title)});a.sdcui.messageUtil.showError(l.join("\n"));this.activeSubmitButton()}},fieldReset:function(){this.element.find(".youi-field").fieldReset();var a=this.options.idKeys;if(a)for(var a=a.split(","),b=0;b<a.length;b++){var d=this.element.find(".youi-field[property="+
a[b]+"]");d.length&&d.fieldEnable&&d.fieldEnable()}},reset:function(){this.fieldReset();this.record&&this.fillRecord(this.record);a.isFunction(window[this.options.id+"_reset"])&&window[this.options.id+"_reset"].apply(this.element[0])},clear:function(){this.element.find(".youi-field").fieldClear();this.record=null},open:function(b,c){this.record=null;a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor();a(".validate-success",this.element).removeClass("validate-success");a(".validate-error",this.element).removeClass("validate-success").removeAttr("title");
this.element.dialog({autoOpen:false,hideCloseIcon:this.options.hideCloseIcon,width:(this.options.width||600)+28,title:this.options.caption,modal:true,minHeight:this.element.outerHeight()+100,overlay:{opacity:0.2,background:"#A8A8A8"},zIndex:this.options.zIndex,close:this.options.close}).show().dialog("open",b,c)},remove:function(){if(window.confirm("\u786e\u8ba4\u5220\u9664\uff1f")){var b=this.options.idKeys;if(b&&this.options.removeAction){for(var b=b.split(","),c=[],d=0;d<b.length;d++){var i=this.element.find(".youi-field[property="+
b[d]+"]").fieldValue();i&&c.push(a.sdcui.parameterUtils.propertyParameter(b[d],i))}c.length&&a.sdcui.ajaxUtil.ajax({url:this.options.removeAction,data:c.join("&"),formId:this.element.attr("id"),formDoc:this.element[0],success:function(b){var d=this.formId+"_afterRemove";if(!a.isFunction(window[d])||window[d].apply(this.formDoc,[b]))this.formDoc=null}})}}},close:function(){this.element.dialog("close");a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor();this.avoidRecordChange=false}});a.extend(a.sdcui.form,
{version:"1.0.0",defaults:{},getter:["getFormRecord","getFieldValues"],extraInputHtml:function(a,b){return'<input class="extra-field" type="hidden" value="'+b+'" name="'+a+'"/>'}})})(jQuery);(function(a){function b(a,b,d,e,i,g,j){var k=[],m=[],m=f(e,a,d),d=["row",e%2?"old":"even"];i&&d.push("row-new");k=['<tr id="'+m+'" class="'+d.join(" ")+'">'];m=['<tr id="'+m+'" class="'+d.join(" ")+'">'];i=false;for(d=0;d<b.length;d++)b[d].fixed==true?(m.push(c(a,b[d],e,d,g,j)),i=true):k.push(c(a,b[d],e,d,g,j));i?m.push("</tr>"):m=[""];k.push("</tr>");return[k.join(""),m.join("")]}function c(b,d,c,f,e,i){var j=[];if(d&&d.property){var f=g(b,d,c,f),k=f.value,m=f.text,q=[];j.push("<td");d.align&&j.push(' align="'+
d.align+'"');d.hidden&&j.push(' style="display:none"');a.isFunction(d.highlight)&&d.highlight(k,b)&&q.push("highlight");d.convert==="radio"&&(q.push("radio"),(k==="1"||k===true)&&q.push("radio-checked"),m="<div></div>");switch(d.type){case "num":m=(e-1)*i+c+1;break;case "checkbox":q.push("checkbox");m="<div></div>";break;case "link":c=[];c.push('<a href="#" onclick="');c.push("link_"+d.property+"(event");if(d.params){var e=typeof d.params=="string"?d.params.split(","):d.params,s=[];a(e).each(function(){s.push("'"+
a.sdcui.recordUtils.getPropertyValue(b,this)+"'")});s.length&&(c.push(","),c.push(s.join(",")))}c.push(');">');d.img?c.push('<img class="cell-button" src="'+d.img+'"></img>'):c.push(f.text);c.push("</a>");m=c.join("")}q.length&&j.push(' class="'+q.join(" ")+'"');f.valueAttrHtml&&j.push(f.valueAttrHtml);j.push(">");j.push(m);j.push("</td>");return j.join("")}}function g(b,d,c,f){var e,i,g;e=a.isFunction(d.defaultValue)?d.defaultValue(b,d,c):d.defaultValue;i=a.sdcui.recordUtils.getPropertyValue(b,d.property);
i=i==null?e:i;e=a.sdcui.serverConfig.convertArray[d.convert];d&&d.convert&&e?(e=e[i]||d.notConvertValue||i,g=' value="'+(i||"")+'" '):e=(typeof i!=="undefined"?""+i:"").toString().replace(/\s/g,"&nbsp;");var j=d.renderer;if(j){if(typeof j==="string")d.renderer=j=a.sdcui.formatUtils[j];typeof j==="function"&&(e=j.call(d,i,b,c,f));if(!g||g=="")g=' value="'+(i||"")+'" '}return{value:i==null?"":i,text:e,valueAttrHtml:g}}function f(b,d,c){if(c){var b=c.split(","),f=[];a.each(b,function(){f.push(a.sdcui.recordUtils.getPropertyValue(d,
this))});b=f.join()}else b="row_"+b;return b}function e(b,c,f){var e={},i=a(b).attr("id");a(b).hasClass("row-new")||(e=d(e,f,i));var g=a.grep(c,function(a){return!a.fixed});a("td",b).each(function(a){var a=g[a],b;a&&a.property&&!a.fixed&&(b=this.getAttribute("value")||this.textContent||this.innerText)&&(e[a.property]=b)});return e}function d(a,b,d){a=a||{};if(b&&d)for(var b=b.split(","),d=d.split(","),c=0;c<b.length;c++)a[b[c]]=d[c];return a}function i(b){var d=a(".grid-scroll tr.row.selected",b).length;
d==0?(a(".youi-button.active-1",b).addClass("disabled"),a(".youi-button.active-2",b).addClass("disabled")):(d==1?a(".youi-button.active-1",b).removeClass("disabled"):a(".youi-button.active-1",b).addClass("disabled"),a(".youi-button.active-2",b).removeClass("disabled"))}function j(a){return!a||!a.orderBy?"":"sort="+a.orderBy+"&order="+(a.sortProperty||a.property)}var k=a.sdcui.log;a.widget("sdcui.grid",a.ui.mouse,a.extend({},a.sdcui.dragSupport,{currentPageIndex:1,options:{editModel:true,maxExportSize:2E3,
exportTitle:"gridData"},_create:function(){k.debug("\u521d\u59cb\u5316grid\u7ec4\u4ef6...");this._initModel();this._defaultHtmls();this._initAction();var a=this.element.is(":visible");if(a)this.contentWidth=this.contentWidth||this.element.width(),this.element.find(">.grid-header .grid-scroll").width(this.contentWidth),this.element.find(">.grid-header .grid-scroll table").width(this.scrollWidth),this.element.find(">.grid-header .grid-scroll table").removeAttr("width");this.options.load?this.reload():
i(this.element);a&&this._resetWidth();this._mouseInit()},_resetWidth:function(){this.contentWidth>0?this.element.find(".grid-scroll").width(this.contentWidth):this.element.find(".grid-scroll").width(this.scrollWidth);if(this.contentWidth>0&&this.contentWidth<this.scrollWidth)this.element.find(".grid-scroll>table.grid-table").width(this.scrollWidth),this.element.find(".grid-x-scroll").addClass("show"),this.contentWidth=this._dectetWidth()-this.fixedWidth,this.element.find(".grid-x-scroll").width(this.contentWidth),
this.element.find(".grid-x-scroll").find(">div").width(this.scrollWidth);else{var a=this.contentWidth-this.scrollWidth;this.isFixCol=true;var b=this.element.find("tr.row-contral td:last");b.width(b.width()+a-10);this.scrollWidth=this.scrollWidth+a-10}this.fixedWidth&&(this.element.find(".grid-fixed").width(this.fixedWidth),this.element.find(".grid-fixed").parent().width(this.fixedWidth))},_dectetWidth:function(){return this.options.width||this.element.width()},_mouseStart:function(b){b=a(b.target);
if(b.hasClass("col")){this.currentDrag=b;this.targetLeft=b.position().left;var d=this.element.find("#col-resize-helper");d.length==0&&(d=a('<div class="col-resize-helper" id="col-resize-helper"></div>').appendTo(this.element));this.helper=d.addClass("resizing").css({top:b.position().top,left:this.targetLeft,width:b.width(),height:this.element.find(".grid-content").height()+28})}},_mouseDrag:function(a){if(this.currentDrag&&this.currentDrag.hasClass("col")&&this.helper)this.position=this._generatePosition(a),
a=this.position.left-this.targetLeft,a>10&&this.helper.width(a)},_mouseStop:function(){this.currentDrag&&this.currentDrag.hasClass("col")&&this._resizeColWidth(this.currentDrag,this.helper.width());this.helper&&this.helper.removeClass("resizing");this.helper=this.currentDrag=null},_resizeColWidth:function(b,d){var c=b.width(),c=d-c,f=this.element.find(".grid-scroll >table").width();if(c!=0){var e=b.prevAll().length;this.fixedCount>0&&(e+=this.fixedCount);e=this.cols[e];this.element.find(".grid-scroll .td-width").each(function(){a(this).width(this.offsetWidth-
2)});this.element.find(".grid-scroll >table").width(f+c);this.element.find(".grid-scroll .td-width."+e.property.replace(".","-")).width(d);this.scrollWidth=f+c;this.contentWidth<this.scrollWidth?(this.element.find(".grid-x-scroll").addClass("show"),this.contentWidth=this._dectetWidth()-this.fixedWidth,this.element.find(".grid-x-scroll").width(this.contentWidth),this.element.find(".grid-x-scroll").find(">div").width(this.scrollWidth)):this.element.find(".grid-x-scroll").removeClass("show")}},_initModel:function(){if(this.options.cols){this._setPageIndex(this.options.currentPageIndex||
1);this.pageCount=this.options.maxPage||1;this.isFixCol=this.isFixCol||false;this.cols=[];this.fixedCount=0;this.fixedWidth=this.element.find(".table-header-fixed").css("visibility","visible").width();this.colGroups={};this.scrollWidth=null;this.showColGroup=false;this.filters=[];this.params=[];this._removeList=[];this.options.scrollHeight&&this.element.find(".grid-content .grid-fixed,.grid-content .grid-scroll").css("height",this.options.scrollHeight);var b=this._dectetWidth(),d=this.options.cols.length,
c=0;if(this.options.showNum==true)this.cols.push({property:"num",type:"num",fixed:true,caption:"num",align:"center",width:25}),this.colGroups.num="num",this.fixedCount++;if(this.options.showCheckbox==true)this.cols.push({property:"checkbox",type:"checkbox",caption:"checkbox",fixed:true,align:"center",width:25}),this.fixedCount++,this.colGroups.checkbox="checkbox";for(var f=0;f<d;f++){var e=a.extend({width:100},this.options.cols[f]);e.fixed==true&&this.fixedCount++;e.group?(this.colGroups[e.group]=
(this.colGroups[e.group]||0)+1,this.showColGroup=true):this.colGroups[e.caption]=e.property;this.cols.push(e);e.fixed||(c+=parseInt(e.width)+2)}this.scrollWidth=c+1;this.contentWidth=b-this.fixedWidth}},_defaultHtmls:function(){this.options.initHtml==true&&(this.element.addClass("youi-grid"),this.element.html(""))},parseRecords:function(d,c){var f=this.element.find(".grid-content .grid-scroll").empty(),e=this.element.find(".grid-content .grid-fixed").empty(),g,j,k=this.element.find(".table-header-fixed tr.row-contral"),
r=this.scrollWidth,m;k.length?(j=k.html(),m=k.width(),g=this.element.find(".table-header tr.row-contral").html(),g='<tr class="row-contral">'+g+"</tr>",this.element.width(),e.parent().width()<=1&&e.parent().width(m+1),k.parents("td:first").width()<=1&&k.parents("td:first").width(m+1)):g=this.element.find(".grid-header table.grid-table tr:first").html();var q=this.currentPageIndex,s=this.options.pageSize,k=a.sdcui.recordUtils.parseRecords(d,{cols:this.cols,idKeys:this.options.idKeys,parseRecord:function(a,
d){return b(d,this.cols,this.idKeys,a,false,q,s)},parse:function(a,b){var d=b[0].join(""),c=b[1].join(""),h=[""],e=[];c?(h.push('<table style="width:'+m+'px" class="grid-table" cellpadding="0" cellspacing="1">'),h.push(j),h.push(c),h.push("</table>"),e.push('<table style="width:'+r+'px" class="grid-table" cellpadding="0" cellspacing="1">')):e=['<table style="width:'+r+'px" class="grid-table"  cellpadding="0" cellspacing="1">'];e.push(g);e.push(d);e.push("</table>");return[e.join(""),h.join("")]}});
f.html(k[0]);e=this.element.find(".grid-content .grid-fixed");e.length&&e.html(k[1]);this._activePager(c);i(this.element);this.lastSelectedIds=null;this.element.find(".grid-x-scroll").trigger("scroll");this._headerScroll();a.isFunction(this.options.afterParse)&&this.options.afterParse()},_headerScroll:function(){var a=this.options.scrollHeight||this.element.find(">.grid-content").innerHeight();this.contentWidth=this.contentWidth||this.element.width();var b=this.element.find(">.grid-content table.grid-table").outerHeight();
this.yScrollShow=this.yScrollShow||false;if(b>=a&&!this.yScrollShow)this.element.find(">.grid-header .grid-scroll").width(this.contentWidth-17),a=this.element.find(".grid-header .grid-scroll tr.row-contral td:last"),a.width(a.width()-17),a=this.element.find(".grid-content .grid-scroll tr.row-contral td:last"),a.width(a.width()-17),this.scrollWidth-=17,this.element.find(">.grid-header .grid-scroll table").width(this.scrollWidth),this.element.find(">.grid-content .grid-scroll table").width(this.scrollWidth),
this.element.find(">.grid-content .grid-scroll table").removeAttr("width"),this.yScrollShow=true},selectRecords:function(b){var d=this.element,c=idKeys.split(",");a(b).each(function(b,h){a(c).each(function(b,c){a(d).find(">.grid-content tr.row[id='"+h[c]+"']").toggleClass("selected")})})},_initAction:function(){var b=this.options.id;a.sdcui.buttonUtils.addButtonActionListener(this.element.find(">.grid-formButtons"),{reset:function(){a("#"+b).grid("reset")},back:function(){a("#"+b).grid("back")},submit:function(){a("#"+
b).grid("submit")}});this.element.find(">.grid-header").click(function(b){var d=a.sdcui.classUtils.getEventClass(b);d=="checkbox"?(a(b.target).toggleClass("checked").hasClass("checked")?a("tr.row",this.parentNode).addClass("selected"):a("tr.row.selected",this.parentNode).removeClass("selected"),i(a(this).parent())):d=="col"&&(b=a(b.target),b.is(".sort")&&a(this.parentNode).grid("toggleSort",b))});var d=this.cols,c=this.options.idKeys,f=this.options.editModel,g=this.fixedCount,j=this.options.clickRowEvent,
k=this.options.afterSelectRowEvent,r=this.element.find(">.grid-content").bind("click",{widgetId:this.options.id},function(b){var h;var i=b.target;if(i)for(;i;){if(a(i).is("tr.row")){h=i;break}i=i.parentNode}else h=null;i=true;if(h!=null){var m=e(h,d,c),q=a(h).prevAll(".row").length+1;j&&j.call(h,m,q);if(a("#"+b.data.widgetId).grid("select",h,b.ctrlKey,b)&&(b=a(b.target),b.is("td")&&b.parents("div .grid-fixed").length<=0)){var r=b.prevAll().length+g;if(b.parent("tr.row-new").length>0||c.indexOf(d[r].property)<
0&&f)m=a.extend({name:d[r].editor,rowIndex:q,colIndex:r+1,record:m},d[r],{initHtml:true},d[r].editorOptions),m.editor&&(delete m.width,delete m.editorOptions,m.editable&&(a(this).trigger("editor.open",[b,m]),i=false));k&&k.call(this,h)}}i&&a.sdcui.editor&&a(this).editor("close")});a.sdcui.editor&&r.editor();this.element.find(">.grid-content .grid-scroll").scroll(function(){a(".grid-fixed",this.parentNode.parentNode).scrollTop(this.scrollTop);a.sdcui.editorFactory&&a.sdcui.editorFactory.closeEditor()});
this.element.find(".grid-x-scroll").scroll(function(){a(this).parents(".youi-grid:first").find(".grid-scroll").scrollLeft(this.scrollLeft)});this.element.find(">.grid-footer").bind("click",function(b){var d=a.sdcui.classUtils.getEventClass(b);if((" "+b.target.className+" ").indexOf(" disabled ")==-1)switch(d){case "pAddRow":a(this.parentNode).grid("addRow");break;case "pRemoveRow":a(this.parentNode).grid("deleteRow");break;case "pFirst":a(this.parentNode).grid("firstPage");break;case "pPrev":a(this.parentNode).grid("prevPage");
break;case "pNext":a(this.parentNode).grid("nextPage");break;case "pLast":a(this.parentNode).grid("lastPage");break;case "pgo":b=a(this.parentNode).find("input.pageIndex").val();if(!b||isNaN(b)||b<1)b=1;b=parseInt(b);a(this.parentNode).grid("goPage",b);break;case "pReload":a(this.parentNode).grid("reload")}});this.element.find(".youi-fieldLayout").bind("keydown",function(b){b.keyCode==13&&a(this).parent().grid("reload")});var m=this.options.pageSize;a.each(this.element.find(".pselect option"),function(){a(this).attr("value")==
m?a(this).attr("selected","selected"):a(this).removeAttr("selected")});this.element.find(".pselect").bind("change",function(){a(this.parentNode.parentNode.parentNode.parentNode).grid("setPageSize",this.value);a(this.parentNode.parentNode.parentNode.parentNode).grid("reload")});this.options.buttonActions=this.options.buttonActions||{};this.options.buttonActions.save&&(this.options.buttonActions.save=function(){a("#"+b).grid("saveRows")});var q=this.options.dataFormId;if(q){var s=this.options.editSrc;
this.options.buttonActions.add&&(this.options.buttonActions.add=function(){a("#"+q).form("fieldReset").addClass("operant-add").form("open",a.sdcui.resourceUtils.get("grid.add"))});if(this.options.buttonActions.edit&&this.options.editSrc){var u=true;this.options.editSrc&&(u=false);c=this.options.idKeys;this.options.buttonActions.edit=function(){var b=a(this).parents(".youi-grid:first").grid("getSelectedRecords")[0];if(b){for(var d=[],h=c.split(","),e=0;e<h.length;e++)d.push(b[h[e]]||"");if(u)a("#"+
q).removeClass("operant-add").form("open",a.sdcui.resourceUtils.get("grid.edit")).form("fillRecord",b);else{b=s;for(e=0;e<h.length;e++)b=a.sdcui.parameterUtils.connectParameter(b,h[e],d[e]);a("#"+q).removeClass("operant-add").form("find",b).form("open",a.sdcui.resourceUtils.get("grid.edit"))}}}}window[q+"_afterSubmit"]=function(d){if(typeof d.success=="undefined"||d.success!==false)a("#"+b).grid("reload",u,d),a("#"+q).form("close")}}this.options.buttonActions.remove&&(this.options.buttonActions.remove=
function(){a(this).parents(".youi-grid:first").grid("removeRecords")});this.options.exportXls&&(this.options.buttonActions.exportXls=function(){a(this).parents(".youi-grid:first").grid("exportXls")});this.options.exportTxt&&(this.options.buttonActions.exportTxt=function(){a(this).parents(".youi-grid:first").grid("exportTxt")});this.options.exportPdf&&(this.options.buttonActions.exportPdf=function(){a(this).parents(".youi-grid:first").grid("exportPdf")});this.options.print&&(this.options.buttonActions.print=
function(){a(this).parents(".youi-grid:first").grid("exportPrint")});a.sdcui.buttonUtils.addButtonActionListener(this.element.find(".grid-buttons"),this.options.buttonActions);this.options.layoutResize!==false&&this.element.addClass("layout-resize-handle").bind("layout.resize",function(){a(this).grid("resize")})},resize:function(){var a=this.element.width(),b=this.element.find(".table-header-fixed:first").width();a-=b;this.element.find(".grid-scroll").scrollLeft(0).width(a);b=this.element.find(".grid-x-scroll");
this.scrollWidth>a?b.addClass("show").width(a).find(">div").width(this.scrollWidth):b.removeClass("show");this.contentWidth=a},validate:function(){var a=this.element.find(".youi-fieldLayout");a.find(".youi-field").fieldValidate();return a.find(".youi-field.validating,.youi-field.validate-error").length==0?true:false},_ajaxDatas:function(){if(this.options.src&&!(a.isFunction(window[this.options.id+"_beforeSubmit"])&&window[this.options.id+"_beforeSubmit"].apply(this.element[0])==false)){var b="#"+
this.options.id+" .pReload.pButton";a(b).addClass("loading");var d=this._getParams();a.sdcui.ajaxUtil.ajax({url:this.options.src,dataType:this.options.srcType,data:d.join("&"),type:"post",id:this.element.attr("id"),success:function(d){var c;d.result?(c=d.result.rows,d=d.result.total):(c=d.records,d=d.totalCount);a("#"+this.id).grid("parseRecords",c,d);a(b).removeClass("loading")},error:function(){a(b).removeClass("loading")}})}},_activePager:function(b){if(b){var d=this.currentPageIndex,c=this.options.pageSize,
e=Math.ceil(b/c);this.pageCount=e;if(d>e)this.currentPageIndex=d,d=e;k.debug("\u8bb0\u5f55\u603b\u6570:"+b+",pageCount:"+e);e<2?this._disableFunButtons(["pFirst","pPrev","pNext","pLast"]):d==1?(this._activeFunButtons(["pNext","pLast"]),this._disableFunButtons(["pFirst","pPrev"])):d==e?(this._activeFunButtons(["pFirst","pPrev"]),this._disableFunButtons(["pNext","pLast"])):this._activeFunButtons(["pFirst","pPrev","pNext","pLast"]);var f=d*c;f>b&&(f=b);b=a.sdcui.resourceUtils.get("grid.pagestat",d,e,
b,(d-1)*c+1,f);this.element.find(".pPageStat").html(b);this.element.find("input.pageIndex").val(d)}else this.element.find(".pPageStat").html(a.sdcui.resourceUtils.get("grid.notFound")),this.element.find("input.pageIndex").val(""),this._disableFunButtons(["pFirst","pPrev","pNext","pLast"])},_activeFunButtons:function(a){this.element.find(".pButton."+a.join(",.pButton.")).removeClass("disabled")},_disableFunButtons:function(a){this.element.find(".pButton."+a.join(",.pButton.")).addClass("disabled")},
_getParams:function(){var b=[],b=b.concat(this._getPagerParams()),b=b.concat(this._getQueryParams()),b=b.concat(this._getSortParams());a.isArray(this.parentParams)&&(b=b.concat(this.parentParams));return b},_getQueryParams:function(){var b=[];if(this.element.find(".youi-fieldLayout").length==0)return b;var d=this.element.find(".youi-fieldLayout").fieldLayout("getFieldValues");d&&a(d).each(function(){this.value&&b.push(a.sdcui.parameterUtils.propertyParameter(this.property,this.value))});return b},
_getSortParams:function(){var b=[],d=this.cols.length,c;if(this.element.find("th.sort").length==0)return b;c=this.element.find("th.sort.sorting");var e=0;if(c.length>=0)e=c.prevAll().length,d=a.grep(this.cols,function(a){return!a.fixed}),b.push(j(d[e]));else for(var f=0;f<d;f++)f!=e&&(c=this.cols[f],c.orderBy&&b.push(j(c)),c=null);return b},setPageSize:function(a){this.options.pageSize=a},_getPagerParams:function(){var a=[];a.push("pageNo="+this.currentPageIndex);a.push("pageSize="+this.options.pageSize);
return a},_setPageIndex:function(a){this.currentPageIndex=parseInt(a)},_showXScroll:function(){var a=this.element.width(),b=this.element.find(">.grid-content table").width();a<b?this.element.find(">.grid-x-scroll").width(a).addClass("show").find(">div").width(b):this.element.find(">.grid-x-scroll").removeClass("show")},toggleSort:function(b){var d=b.prevAll().length,d=a.grep(this.cols,function(a){return!a.fixed})[d];this.element.find("th.sorting").removeClass("sorting");b.addClass("sorting").toggleClass("desc").is(".desc")?
(d.orderBy="desc",b.removeClass("asc")):(d.orderBy="asc",b.addClass("asc"));this.reload()},firstPage:function(){this.goPage(1)},prevPage:function(){this.goPage(this.currentPageIndex-1)},nextPage:function(){this.goPage(this.currentPageIndex+1)},lastPage:function(){this.goPage(this.pageCount)},goPage:function(a){a<1&&(a=1);if(this.pageCount>0&&a>this.pageCount)a=this.pageCount;this.pageCount==1&&this.element.find("input.pageIndex").val(1);this.currentPageIndex!=a&&(this._setPageIndex(a),this._ajaxDatas())},
select:function(b,d,c){var d=this._getSelectedIds(),f=this.options.selectRowEvent,g=this.cols,j=this.options.idKeys,k=this.element;a(b);var r=null,m=null,m=a(b).prevAll().length;if(f){var q=[];a(d).each(function(b,d){var c=a(k).find(">.grid-content .grid-scroll tr.row[id='"+d+"']");q.push(e(c,g,j))});if(c&&!f.call(this,d,b,q,e(b,g,j),a(c.target),g))return true}this.fixedCount>0&&(r=this.element.find(".grid-content .grid-fixed tr:eq("+m+")"),r.toggleClass("selected"));m=this.element.find(".grid-content .grid-scroll tr:eq("+
m+")");m.toggleClass("selected");!this.options.showCheckbox&&!this.options.multiple&&this.element.find(">.grid-content tr.row.selected").not(m).not(r).removeClass("selected");a(b).hasClass("hasTitle")||a(b).addClass("hasTitle").find(">td").not(".validate-error").each(function(){a(this).attr("title",a(this).text())});if(!this.lastSelectedIds||this.lastSelectedIds&&this.lastSelectedIds.join()!=d.join())this.lastSelectedIds=d,a.isFunction(window[this.options.id+"_change"])&&window[this.options.id+"_change"].apply(b,
[e(b,g,j)]);i(this.element);return true},_getSelectedIds:function(){var a=[];this.element.find(">.grid-content .grid-scroll tr.row.selected").each(function(){a.push(this.getAttribute("id"))});return a},getSelectedKeys:function(){return this._getSelectedIds()},back:function(){window.history.go(-1)},submit:function(){this.currentPageIndex=1;if(this.validate())this._ajaxDatas();else{var b=[];this.element.find(".youi-field.validating,.youi-field.validate-error").each(function(){this.title&&b.push(this.title)});
a.sdcui.messageUtil.showError(b.join("\n"))}},isEditedCell:function(){return this._removeList&&this._removeList.length>0||this.element.find(".grid-content .grid-scroll .grid-table tr.row-new").length>0||this.element.find(".grid-content .grid-scroll .grid-table .edited").length>0},reload:function(b,d,c){c&&this._setPageIndex(1);this.isEditedCell()?window.confirm(a.sdcui.resourceUtils.get("grid.confirm.reload.notSubmit"))&&(delete this._removeList,b?this._updateOrAddRow(d):this._ajaxDatas()):b?this._updateOrAddRow(d):
this._ajaxDatas()},getBatchRecords:function(){var b=this.options.idKeys,d=this.cols;if(this.element.find(">.grid-content").editor("close")===false)return false;var c=this.options.insertAlias||"insert",e=this.options.editAlias||"edit",f=this.options.delAlias||"delete",i=[],g=function(e,f){var g=f.getAttribute("id");if(b&&g&&g.indexOf("row_")==-1)for(var j=b.split(","),g=g.split(","),k=0;k<j.length;k++)i.push(c+"["+e+"]."+j[k]+"="+g[k]);var o=a.grep(d,function(a){return!a.fixed});a("td",f).each(function(a){var a=
o[a],b;a&&a.property&&(b=this.getAttribute("value")||this.textContent||this.innerText)&&i.push(c+"["+e+"]."+a.property+"="+b)})},j=0,k=function(c){var f=c.getAttribute("id");if(a("td",c).is(".edited")){if(b)for(var g=b.split(","),f=f.split(","),k=0;k<g.length;k++)i.push(e+"["+j+"]."+g[k]+"="+f[k]);var n=a.grep(d,function(a){return!a.fixed});a("td",c).each(function(a){var a=n[a],b;a&&a.property&&(b=this.getAttribute("value")||this.textContent||this.innerText)&&i.push(e+"["+j+"]."+a.property+"="+b)});
j++}};this.element.find(".grid-content .grid-scroll .grid-table tr.row-new").each(function(a){g(a,this)});this.element.find(".grid-content .grid-scroll .grid-table tr").not(".row-new").each(function(){k(this)});if(this._removeList&&b){var q=b.split(",");a(this._removeList).each(function(a,b){for(var d=b.split(","),c=0;c<q.length;c++)i.push(f+"["+a+"]."+q[c]+"="+d[c])})}return i.length==0?null:i=i.concat(this._getQueryParams())},validateBatchRecords:function(){var b=this.element.find(">.grid-content"),
d=function(d,c,e,f,i){if(e.is("td")&&e.parents("div .grid-fixed").length<=0&&(f=e.prevAll().length+f,d=a.extend({name:d[f].editor,rowIndex:i,colIndex:f+1,record:c},d[f],{initHtml:true},d[f].editorOptions),d.editor))delete d.width,delete d.editorOptions,d.isCheck=true,a(b).trigger("editor.open",[e,d]),a(b).trigger("editor.close",[e]),a(b).trigger("mousedown")},c=this.cols,f=this.options.idKeys,i=this.fixedCount;this.element.find(".grid-content .grid-scroll .grid-table tr.row-new").each(function(b,
g){var h=a(g).prevAll(".row").length+1,j=e(g,c,f);a(g).find("td").each(function(b,e){d(c,j,a(e),i,h)})});this.element.find(".grid-content .grid-scroll .grid-table tr").not(".row-new").each(function(b,g){var h=a(g).prevAll(".row").length+1,j=e(g,c,f);a(g).find("td.edited").each(function(b,e){d(c,j,a(e),i,h)})});var g=[];this.element.find(".youi-editor .validate-error").each(function(){g.push(this.title)});return g},saveRows:function(b,d){var b=true,c=this.validateBatchRecords();if(c.length)return a.sdcui.messageUtil.showError(c.join("\n")),
false;c=this.getBatchRecords();if(!c)return false;if(!this.options.preSaveRowsEvent||this.options.preSaveRowsEvent.call(this,c)){if(!this.options.saveRowsSrcs)return false;a.sdcui.ajaxUtil.ajax({url:this.options.saveRowsSrcs,data:c.join("&"),grid:this,noReload:b,success:function(a){if(d){if(a.success&&a.success===true)this.grid._updateNewRowId(a);else{alert(a.msg);this.grid=null;return}this.grid._addRowDom(this.grid)}this.grid._afterSaveRows(a,this.noReload);this.grid=null}})}return c},_updateNewRowId:function(a){this.element.find(".grid-content .grid-scroll .grid-table tr.row-new").attr("id",
a.idKeys)},_afterSaveRows:function(a,b){if(!this.options.afterSaveRowsEvent||this.options.afterSaveRowsEvent.call(this,a))this.clearBatchData(),b!=true&&this.reload()},clearBatchData:function(){delete this._removeList;this.element.find(".grid-content .grid-scroll .grid-table tr.row-new").removeClass("row-new");this.element.find(".grid-content .grid-scroll .grid-table .edited").removeClass("edited")},addRow:function(){this.element.trigger("mousedown");var a=this.element.find("tr.row-new:last");if(!a.length||
a.text())this.options.autoSave&&this.options.autoSave===true?this.saveRows(true,this.options.autoSave)||this._addRowDom():this._addRowDom()},_addRowDom:function(){var b=this.options.defaultAddRecord||{};b.count==0&&a.each(this.cols,function(a,d){b[d.property]=d.defaultValue});a.isFunction(this.options.beforeAddRow)&&this.options.beforeAddRow.apply(this,[b]);this._addRow(b,true);this.select(this.element.find(">.grid-content .grid-scroll>.grid-table tr:first").next()[0],false)},_updateOrAddRow:function(){},
_addRow:function(d,c){var d=d||{},e=this.element.find(">.grid-content .grid-scroll>.grid-table");if(!e.length){var f=this.element.find(">.grid-header .table-header-fixed .row-contral");this.fixedCount>0&&(e=f.html(),f=f.width(),this.element.find(">.grid-content .grid-fixed").append('<table class="grid-table" width="'+f+'" cellspacing="1" cellpadding="0">'+e+"</table>"),a.browser.msie?this.element.find(".grid-content .grid-fixed").parent().width(f-1):this.element.find(".grid-content .grid-fixed").parent().width(f+
1));e=this.element.find(">.grid-header .grid-scroll .row-contral").html();e=a('<table class="grid-table" width="'+this.scrollWidth+'" cellspacing="1" cellpadding="0"><tr>'+e+"</tr></table>");this.element.find(">.grid-content .grid-scroll").append(e)}e.find("tr.row");f=b(d,this.cols,this.idKeys,0,c,this.currentPageIndex,this.options.pageSize);e.find("tr:first").nextAll().toggleClass("even").toggleClass("old");e.find("tr:first").after(f[0]);this.fixedCount>0&&(this._updateFixedNum(this.cols),this.element.find(">.grid-content .grid-fixed .grid-table tr:first").nextAll().toggleClass("even").toggleClass("old"),
this.element.find(">.grid-content .grid-fixed .grid-table tr:first").after(f[1]));a(this.element.find(">.grid-content .grid-scroll")).animate({scrollTop:this.scrollHeight},1E3)},_updateFixedNum:function(){this.element.find(">.grid-content .grid-fixed .grid-table tr:first").nextAll().each(function(b,d){a(d).html().indexOf("input")<0&&a(d).find("td").text(b+2)})},_insertRow:function(){},_updateRow:function(){},deleteRow:function(){this.element.find(">.grid-content .grid-scroll tr.row.selected").length==
0&&alert(a.sdcui.resourceUtils.get("grid.noSelectMsg"));if(this.options.idKeys){var b=this._removeList=this._removeList||[];this.element.find(">.grid-content .grid-scroll tr.row.selected").each(function(){this.getAttribute("id").indexOf("row_")!=0&&b.push(this.getAttribute("id"))});this.element.find(">.grid-content tr.row.selected").remove()}},_deleteRow:function(){},exportPrint:function(){this._exportRecords("print")},exportXls:function(){this._exportRecords("xls")},exportTxt:function(){this._exportRecords("txt")},
exportPdf:function(){this._exportRecords("pdf")},_exportRecords:function(b){if(this.options.src){var d=a("#"+this.options.id+"_exportHelper"),c="";if(this.element.find(".youi-fieldLayout").length){var e=this.element.find(".youi-fieldLayout").fieldLayout("getFieldValues");e&&a(e).each(function(){this.value&&(c+=""+this.property+"="+this.value+"&")})}d.length||(flag=this.options.src.indexOf("?")>0?"&":"?",d=a('<form target="_blank" method="post" action="'+this.options.src+flag+c+'exportXls=exportXls"> </form>').appendTo("body",
document));d.html(this._getExportFormHtmls(b));d.submit()}},_getExportFormHtmls:function(a){var b=[],d=this.options.maxExportSize;b.push('<input name="pager:export" value="'+a+'" type="hidden"/>');b.push('<input name="pager:pageIndex" value="1" type="hidden"/>');b.push('<input name="pager:pageSize" value="'+d+'" type="hidden"/>');b.push('<input name="pager:exportTitle" value="'+encodeURIComponent(this.options.exportTitle)+'" type="hidden"/>');for(var a=this.cols.length,c,e=0;e<a;e++)if(d=this.cols[e],
c=d.property,c!="checkbox"&&c!="num")d.caption=d.caption||"",b.push('<input name="pager:header" value="'+d.caption+'" type="hidden"/>'),b.push('<input name="pager:property" value="'+d.property+'" type="hidden"/>');return b.join("")},getSelectedRecords:function(){return this.getRecords(true)},setSelectedRecords:function(b){for(var d=this.options.idKeys.split(","),c=0;c<b.length;c++){for(var e=[],f=0;f<d.length;f++)e.push(a.sdcui.recordUtils.getPropertyValue(b[c],d[f]));this.element.find("tr#"+e.join()).addClass("selected")}},
getRecord:function(a){return e(a,this.cols,this.options.idKeys)},triggerCloseEdited:function(){var b=this.element.find(">.grid-content");this.element.find(".grid-content .grid-scroll .grid-table tr.row-new td").each(function(d,c){a(b).trigger("editor.close",[a(c)]);a(b).trigger("mousedown")});this.element.find(".grid-content .grid-scroll .grid-table tr").not(".row-new").each(function(d,c){a(c).find("td.editing").each(function(d,c){a(b).trigger("editor.close",[a(c)]);a(b).trigger("mousedown")})})},
loadByParents:function(a){this.parentParams=a;this._ajaxDatas()},getRecords:function(a){var b=[],d=this.options.idKeys,c=this.cols;this.element.find(">.grid-content .grid-scroll tr.row"+(a?".selected":"")).each(function(){b.push(e(this,c,d))});return b},getFormRecords:function(){var b=this.options.idKeys,d=this.cols;this.element.find(">.grid-content").editor("close");var c=this.options.insertAlias||"insert",e=this.options.editAlias||"edit",f=this.options.delAlias||"delete",i=this.fixedCount,g={},
j=function(e,f){var j=f.getAttribute("id"),k={};g[c]=g[c]||[];if(b&&j&&j.indexOf("row_")!=0)for(var m=b.split(","),j=j.split(","),o=0;o<m.length;o++)k[m[o]]=j[o];a("td",f).each(function(a){var a=d[a+i],b;a&&a.property&&(b=this.getAttribute("value")||this.textContent||this.innerText)&&(k[a.property]=b)});g[c].push(k)},k=0,q=function(c){var f=c.getAttribute("id"),j={};g[e]=g[e]||[];if(a("td",c).is(".edited")){if(b)for(var n=b.split(","),f=f.split(","),p=0;p<n.length;p++)j[n[p]]=f[p];a("td",c).each(function(a){var a=
d[a+i],b;a&&a.property&&(b=this.getAttribute("value")||this.textContent||this.innerText)&&(j[a.property]=b)});g[e].push(j);k++}};this.element.find(".grid-content .grid-scroll .grid-table tr.row-new").each(function(a){j(a,this)});this.element.find(".grid-content .grid-scroll .grid-table tr").not(".row-new").each(function(){q(this)});if(this._removeList&&b){var s=b.split(",");g[f]=g[f]||[];a(this._removeList).each(function(a,b){for(var d={},c=b.split(","),e=0;e<s.length;e++)d[s[e]]=c[e];g[f].push(d)})}return g},
setColsDefaultValue:function(a){for(var b,d=0;d<this.cols.length;d++)if(b=a[this.cols[d].property])this.cols[d].defaultValue=b},removeRecords:function(){var b=this.options.idKeys;if(b&&this.options.removeSrc){for(var d=this.getSelectedKeys(),b=b.split(","),c=[],e=[],f=0;f<d.length;f++){for(var c=d[f].split(","),g=0;g<b.length;g++)e.push(a.sdcui.parameterUtils.propertyParameter(b[g],c[g]));c=null}window.confirm(a.sdcui.resourceUtils.get("grid.confirm.remove",d.length))&&(this.element.find(">.grid-content tr.row.selected").remove(),
this.element.find(">.grid-content tr.row").length<=0&&this.currentPageIndex-1>0&&(this.currentPageIndex-=1),a.sdcui.ajaxUtil.ajax({url:this.options.removeSrc,data:e.join("&"),widgetId:this.options.id,success:function(){a("#"+this.widgetId).grid("reload")}}))}},reset:function(){this.element.find(".youi-fieldLayout .youi-field").fieldReset()},destroy:function(){this.element.removeClass("youi-grid");a.widget.prototype.destroy.apply(this,arguments)},width:function(a){this.element.width(a);this.element.find(">.grid-content").width(a);
this._showXScroll()}}));a.extend(a.sdcui.grid,{version:"1.0.0",defaults:{srcType:"json",containerParent:"#system-container",delay:100,editModel:true,distance:1,initHtml:true}})})(jQuery);(function(a){a.widget("sdcui.mousable",a.ui.mouse,{_create:function(){this.element.disableSelection();this._mouseInit()},_mouseStart:function(a){if(!this._trigger("start",a))return false},_mouseDrag:function(a){this._trigger("drag",a)},_mouseStop:function(a){this._trigger("stop",a)},_mouseCapture:function(){return true}});a.extend(a.sdcui.mousable,{defaults:{delay:0,distance:1}})})(jQuery);(function(a){a.sdcui&&a.sdcui.resource&&a.extend(a.sdcui.resource,{loading:"\u6570\u636e\u8bfb\u53d6\u4e2d\uff0c\u8bf7\u7a0d\u5019...",urlNotFound:a.sdcui.getMessage("\u5730\u5740\u3010{0}\u3011\u8bbf\u95ee\u5f02\u5e38!"),"grid.add":"\u589e\u52a0","grid.notFound":"\u672a\u627e\u5230\u8bb0\u5f55.","grid.edit":"\u4fee\u6539","grid.remove":"\u5220\u9664","grid.pagestat":a.sdcui.getMessage("{0}/{1}\u9875,{2}\u6761,\u663e\u793a{3}-{4}."),"grid.confirm.remove":a.sdcui.getMessage("\u786e\u8ba4\u5220\u9664\u9009\u4e2d\u7684{0}\u6761\u8bb0\u5f55?"),
"grid.noSelectMsg":"\u8bf7\u9009\u62e9\u4e00\u6761\u8bb0\u5f55","grid.confirm.reload.notSubmit":"\u5237\u65b0\u8868\u683c\u4f1a\u4e22\u5931\u672a\u63d0\u4ea4\u7684\u6570\u636e,\u662f\u5426\u7ee7\u7eed?","grid.records.notFount":"\u672a\u627e\u5230\u8bb0\u5f55!","grid.editor.errorMessage":a.sdcui.getMessage("\u7b2c{0}\u884c\uff0c\u7b2c{1}\u5217\uff1a{2}."),"form.invalid":a.sdcui.getMessage("\u6821\u9a8c\u63d0\u793a\uff1a{0}."),error:"\u5f02\u5e38"})})(jQuery);(function(a){function b(b){b&&b.length!=0&&(b.addClass("last"),a.browser.msie&&b.hasClass("expandable")&&(b.hasClass("expanded")?b.addClass("lastExpanded"):b.addClass("lastExpandable")))}function c(b,c,f,g){var h=["<ul>"],l=f.idAttr||c.idAttr,n=f.textAttr||c.textAttr;a(c.recordPath||"record",g).each(function(){var b=a(l,this).text(),d=a(n,this).text(),f={src:a("src",this).text(),idAttr:a("idAttr",this).text()||l,textAttr:a("textAttr",this).text()||n},g={leaf:a("leaf",this).text(),check:a("check",
this).text()||c.check};h.push(e(b,d,f,g))});h.push("</ul>");b.append(h.join(""))}function g(b,c,f,g){var g=g.records,h=["<ul>"],l=f.leaf?null:c.iteratorSrc,n=c.iteratorParentAttr,o=f.idAttr||c.idAttr,p=f.textAttr||c.textAttr;textAttrs=p.split(".");g.length==0?b.removeClass("expandable").removeClass("expanded").removeClass("lastExpandable").find(">span").removeClass("expandable").removeClass("expanded"):(a(g).each(function(){var b;b=textAttrs.length>1?this[textAttrs[0]][textAttrs[1]]:this[p];var d=
this[o],f=this.src||(!l?null:a.youi.parameterUtil.connectParameter(l,n,d)),g={},j={leaf:this.leaf,check:this.check||c.check,group:this.group};f&&(g={src:this.src||f,idAttr:this.idAttr||o,textAttr:this.textAttr||p});d&&b&&h.push(e(d,b,g,j))}),h.push("</ul>"),b.append(h.join("")))}function f(a){return{src:a.attr("src"),idAttr:a.attr("idAttr"),textAttr:a.attr("textAttr")}}function e(a,b,c,e){var a=['<li id="'+a+'"'],f=["treeNode"],g=["tree-span"],n="";f.push("expandable");g.push("expandable");n='<div class="tree-trigger"></div>';
e&&e.check&&(f.push("check"),g.push("check"),e.check!=true&&(f.push(e.check),g.push(e.check)));e&&e.group&&(f.push(e.group),g.push(e.group));a.push(' class="'+f.join(" ")+'" ');if(c)for(var o in c)c[o]&&(a.push(o),a.push('="'),a.push(c[o]+'" '));a.push(">");a.push(n);a.push('<span title="'+b+'" '+(g?'class="'+g.join(" ")+'"':"")+'><a class="tree-a" href="#">');a.push(b);a.push("</a></span></li>");return a.join("")}a.widget("sdcui.tree",a.extend({},a.ui.mouse,{options:{serverPath:"",srcDataType:"json",
dataParse:function(b){var e=a.extend({},a.data(this.element[0],"tree").options,f(this.treeNodeElement)),j=f(this.treeNodeElement);e.srcDataType=="xml"?c(this.treeNodeElement,e,j,b):e.srcDataType=="json"&&g(this.treeNodeElement,e,j,b);return""},root:"\u6839\u8282\u70b9",idAttr:"value",textAttr:"show",autoLoad:true,checkedChildren:true,checkedParents:true,dragDrop:false,delay:0,distance:1},_create:function(){this.element.addClass("youi-tree").disableSelection();this._initAction();this.options.iteratorSrc&&
this.options.autoLoad==true?this.loadIteratorRoot():(this.options.hideRoot==true&&this.element.find(".root>span").hide(),this._expandNode(this.element.find("li.treeNode:first"),this.options.after));this.options.dragable===true&&this._dragDropSupport()},loadIteratorRoot:function(){if(this.options.iteratorSrc&&this.element.find("li.root").length==0){var a=this.options,b=this.options.iteratorSrc,b=b+(b.indexOf("?")==-1?"?":"&")+this.options.iteratorParentAttr+"=";this.element.html("").append('<ul><li class="treeNode root" src="'+
b+'" idAttr="'+a.idAttr+'" textAttr="'+a.textAttr+'"><span style="display:none;"><a>'+a.root+"</a></span></li></ul>");this._loadSrc(this.element.find("li:first"),this.options.after)}},_dragDropSupport:function(){this.options.container=this.options.container||a("body",document);this.element.prepend('<div id="tree-drop-marker" class="tree-drop-marker"></div>');this._mouseInit()},_mouseStart:function(b){var c=a(b.srcElement||b.target);if(c.is("li>span>a"))this.currentDrag=c.parent().parent(),this.helper=
this._createHelper(b,c),this.dropMarker=this.element.find("#tree-drop-marker");return true},_mouseDrag:function(b){var c=a(b.srcElement||b.target);if(this.helper)if(this.position=this._generatePosition(b),this.helper.css(this.position),c.is("li>span>a")&&this.options.dropable){this.currentDrop=c.parent().parent();dropMarker=this.dropMarker;if(this.currentDrop[0]==this.currentDrag[0]||this.currentDrop[0]==this.currentDrag[0].parentNode.parentNode||a.ui.contains(this.currentDrag[0],this.currentDrop[0]))return this.helper.addClass("drop-no"),
dropMarker.removeClass(),false;else this.helper.removeClass("drop-no");var b=b.pageY-c.offset().top-8,e={left:c.offset().left-dropMarker.parent().offset().left-10};b<-3?(e.top=c.offset().top-dropMarker.parent().offset().top-4,dropMarker[0].className="tree-drop-marker marker-top"):b>2?(e.top=c.offset().top+12-dropMarker.parent().offset().top,dropMarker[0].className="tree-drop-marker marker-bottom"):(e.top=c.offset().top+4-dropMarker.parent().offset().top,dropMarker[0].className="tree-drop-marker marker-middle");
a.browser.msie&&(e.top-=1);dropMarker.css(e)}else if(c.hasClass(this.options.dropStyle)){if(this.currentDrop&&this.currentDrop[0]!=c[0]&&this._dropOut(),!this.currentDrop||this.currentDrop[0]!=c[0])this.currentDrop=c,this._dropOver(c)}else this.currentDrop&&this._dropOut(),this.currentDrop=null},_mouseStop:function(b){if(this.helper)this.currentDrop&&this.currentDrag&&!this.helper.is(".drop-no")?(this.options.stop=a.isFunction(this.options.stop)?this.options.stop:function(){a(this).tree("dropNode")},
this._trigger("stop",b,{dragNode:this.currentDrag,dropNode:this.currentDrop,dragParent:this._getDragParent()}),this._dropOut()):this._trigger("stop",b,{dragNode:this.currentDrag}),this.currentDrop=this.currentDrag=null,this.helper.remove(),this.dropMarker.removeClass(),this.position=this.helper=this.dropMarker=null;return false},_mouseCapture:function(){return true},_createHelper:function(b,c){var e=a('<span class="drop-yes" id="tree-drop-helper"></span>').append(c.clone());e.parents("body").length||
e.appendTo(this.options.container?this.options.container:this.currentDrag);e[0]!=this.element[0]&&!/(fixed|absolute)/.test(e.css("position"))&&e.css("position","absolute");return e},_dropOver:function(b){b.addClass("droping");var c="func_"+this.options.id+"_dropOver";if(a.isFunction(window[c])&&window[c](b)==false)this.currentDrop=null},_dropOut:function(){var b="func_"+this.options.id+"_dropOut";this.currentDrop&&this.currentDrop.removeClass("droping");if(this.currentDrop&&a.isFunction(window[b]))window[b](this.currentDrop)},
_generatePosition:function(a){var b=a.pageX,a=a.pageY,c=this.options.container?this.options.container.offset():this.element.offset();return{top:a+10-c.top,left:b+5-c.left}},_getDragParent:function(){return this.dropMarker.is(".marker-middle")?this.currentDrop:this.currentDrop.parent().parent()},dropNode:function(){this.currentDrag&&this.currentDrop&&this._dropNode()},_dropNode:function(){var b=this.dropMarker;b.is(".marker-top")&&!this.currentDrop.is(".root")?this._doSelfDrop("before"):b.is(".marker-middle")?
this.currentDrop.hasClass("expanded")?this._doSelfDrop():this._expandNode(this.currentDrop,function(){a.data(a(this).parents(".youi-tree:first")[0],"tree")._doSelfDrop()}):b.is(".marker-bottom")&&!this.currentDrop.is(".root")&&this._doSelfDrop("after")},_doSelfDrop:function(a){this.moveTreeNode(this.currentDrag,this.currentDrop,a);this.currentDrag=this.currentDrop=null},moveTreeNode:function(a,b,c){this._relativeNodeByRemove(a);switch(c){case "before":this._addBefore(b,a);break;case "after":this._addAfter(b,
a);break;default:this._addChild(b,a)}this.selectedNode(null,a);this.currentDrag=this.currentDrop=null},_initAction:function(){this.element.bind("click",function(b){var c=b.target,e;switch(a.sdcui.classUtils.getEventClass(b)){case "tree-trigger":a(this).tree("triggerNode",a(c.parentNode));break;case "tree-span":e=a(c.parentNode);break;case "tree-a":e=a(c.parentNode.parentNode)}e&&(e.hasClass("check")&&a(this).tree("checkNode",b,e),a(this).tree("selectedNode",b,e));return false}).bind("dblclick",function(b){var b=
a(b.srcElement||b.target),c;b.is("li.treeNode>span>a")&&(c=b.parent().parent());c&&(c.hasClass("expandable")&&a(this).tree("triggerNode",c),a(this).tree("dblclickNode",c));return false}).bind("mousedown",function(b){if(b.button==2){var c=b.target;if(a.sdcui.classUtils.getEventClass(b)=="tree-a"){b="func_"+this.getAttribute("id")+"_rightClick";if(a.isFunction(window[b]))window[b](a(c.parentNode.parentNode));return false}}})},dblclickNode:function(b){a.isFunction(this.options.dblclick)&&this.options.dblclick.apply(b[0])},
selectedNode:function(b,c){if(c){var e=this.element.find(".selected");e[0]!=c[0]&&(c.addClass("selected"),c.find("a:first").addClass("selected"),e.removeClass("selected"),e.find("a:first").removeClass("selected"),a.isFunction(this.options.select)&&this.options.select.apply(c[0],[this.element[0]]),a.isFunction(window[this.options.id+"_change"])&&window[this.options.id+"_change"].apply(c[0],[this.element[0]]))}},checkNode:function(b,c){c.toggleClass("checked").removeClass("partchecked");c.children("span").toggleClass("checked").removeClass("partchecked");
!b.ctrlKey&&this.options.checkedChildren&&(c.hasClass("checked")?c.find(">ul").find(".check").not(".hide").removeClass("partchecked").addClass("checked"):c.find(">ul").find(".check").not(".hide").removeClass("checked").removeClass("partchecked"));!b.ctrlKey&&this.options.checkedParents&&this._checkParentNode(c);a.isFunction(this.options.select)&&this.options.select.apply(c[0],[this.element[0]]);a.isFunction(window[this.options.id+"_change"])&&window[this.options.id+"_change"].apply(c[0],[this.element[0]])},
_checkParentNode:function(a){var b=a.siblings(".check").length,c=a.siblings(".checked").length,e=a.parent().parent(".check");if(e.length!==0){var f=true;a.hasClass("checked")?b==c&&(this._addCheckedClass(e),f=false):!a.hasClass("partchecked")&&c===0&&(this._removeCheckedClass(e),f=false);f&&this._addPartcheckedClass(e);this._checkParentNode(e)}},_addCheckedClass:function(a){a.length>0&&a.addClass("checked").removeClass("partchecked").children("span").addClass("checked").removeClass("partchecked")},
_addPartcheckedClass:function(a){a.length>0&&a.addClass("partchecked").removeClass("checked").children("span").addClass("partchecked").removeClass("checked")},_removeCheckedClass:function(a){a.length>0&&a.removeClass("checked").removeClass("partchecked").children("span").removeClass("checked").removeClass("partchecked")},unCheckedNode:function(a){this._removeCheckedClass(this.element.find("#"+a))},triggerNode:function(a){a.hasClass("expanded")?this._collapseNode(a):this._expandNode(a)},_triggerClass:function(b){b.hasClass("expandable")&&
(b.toggleClass("expanded"),b.children("span").toggleClass("expanded"),a.browser.msie&&(b.is(".last.expanded")?b.addClass("lastExpanded").removeClass("lastExpandable"):b.is(".lastExpanded")&&b.addClass("lastExpandable").removeClass("lastExpanded")))},_expandNode:function(b,c,e){var f=b.attr("src"),c=(e=e||c)&&c;b.hasClass("expanded")||this._triggerClass(b);b.find("ul:first").show();f&&!b.hasClass("loaded")?this._loadSrc(b,c,e):a.isFunction(e)&&e.apply(b[0],[c]);a.browser.msie&&a.browser.version==6&&
this.element.find(">tree-trigger").css({position:"absolute"});this.element.scrollTop(0)},_loadSrc:function(b,c,e){var f=this.options,g=b.attr("src"),c=(e=e||c)&&c;b.find("span:first").addClass("loading");a.sdcui.ajaxUtil.ajax({url:g,dataType:f.srcDataType,contentType:"application/x-www-form-urlencoded;charset=UTF-8",dataParse:f.dataParse,element:this.element,treeNodeElement:b,afterExpand:e,afterExpandData:c,success:function(b){this.dataParse.apply(this,[b]);this.treeNodeElement.addClass("loaded").find("span:first").removeClass("loading");
b=this.treeNodeElement.find(">ul>li:last");b.addClass("last");this.treeNodeElement.find("ul:first").show();b.hasClass("expandable")&&b.addClass("lastExpandable");a.isFunction(this.afterExpand)&&this.afterExpand.apply(this.treeNodeElement[0],[this.afterExpandData]);this.element=this.treeNodeElement=this.dataParse=null},error:function(){}})},_addChild:function(d,c){var e=d.find(">ul");if(e.length==0)e=a("<ul></ul>").appendTo(d);else{var f=e.find(">li:last");f&&f.length!=0&&f.removeClass("last").removeClass("lastExpanded").removeClass("lastExpandable")}e.children().length==
0&&(d.addClass("expandable expanded").children("span:first").addClass("expandable expanded"),d.hasClass("last")&&d.addClass("lastExpanded"),d.prepend('<div class="tree-trigger"></div>'));b(c);e.append(c)},_addBefore:function(a,b){a.before(b)},_addAfter:function(a,b){a.after(b);a.is(".last")&&(a.removeClass("last").removeClass("lastExpandable").removeClass("lastExpanded"),b.addClass("last"))},_removeNode:function(a){a.length==0||a.hasClass("root")||(this._relativeNodeByRemove(a),this.selectedNode(null,
this._nextNode(a)),a.remove())},_nextNode:function(a){var b=a.next();b.length==0&&(b=a.parent().parent());b.hasClass("root")&&(b=b.find("li.treeNode:first"));return b},_relativeNodeByRemove:function(c){if(c.is(".last")){var e=c.prev(),f=c.parent().parent();e.length>0?b(e):(f.removeClass("expandable").removeClass("expanded"),f.children("span:first").removeClass("expandable").removeClass("expanded"),f.removeClass("lastExpanded").removeClass("lastExpandable"),a.browser.msie&&f.find(">ul").hide());c.removeClass("last")}},
_collapseNode:function(a){this._triggerClass(a);a.find("ul:first").hide()},getSelected:function(){var a=this.element.find("li.treeNode.selected");return a.length==0?null:a},openPath:function(b){if(b){var b=b.split("/"),c=this.element.find("li#"+b.shift());c.length!=0&&(b.length==0?(this.selectedNode(null,c),c.find("a:first").focus()):this._expandNode(c,{treeElement:this.element[0],subPath:b.join("/")},function(b){a(b.treeElement).tree("openPath",b.subPath)}))}},addNode:function(b,c,f,g,h,l,n){h=e(c,
f,g,h);if((b=b||this.getSelected()||this.element.find("li:first"))&&b.length!=0)switch(n){case "before":this._addBefore(b,a(h));break;case "after":this._addAfter(b,a(h));break;default:b.hasClass("expanded")?this._addChild(b,a(h)):(h={tree:this,treeNode:b,addNodeHtml:h,afterAdd:l},this._expandNode(b,h,function(b){b.tree._addChild(a(this),a(b.addNodeHtml));a.isFunction(l)&&l.apply(this)}),h=null)}},removeNode:function(a){a=this.element.find("li.treeNode#"+a);a.length==0&&(a=this.getSelected());this._removeNode(a)},
getNodeById:function(a){return this.element.find("li.treeNode#"+a)},ajaxRemoveNode:function(b,c,e,f){if(b){var g=this.element.attr("id");window.confirm(f||"\u786e\u8ba4\u5220\u9664\uff1f")&&a.youi.ajaxUtil.ajax({url:b,type:"GET",data:a.youi.parameterUtil.propertyParameter(c,e),success:function(){a("#"+g).tree("removeNode",e)}})}},checkedTreeNodes:function(b,c){this.clearCheckedTreeNodes();a.isArray(b)&&this.expandAll(null,function(){a(this);a("li.treeNode",this).each(function(){var c=this.getAttribute("id");
a.inArray(c,b)!=-1&&a(this).addClass("checked").find(">span:first").addClass("checked")})},c?false:b)},checkedTreeNode:function(a){var b=this.element.find("li#"+a);if(b.length>0){var c=[];b.parents("li.treeNode",this.element).each(function(){c.push(this.getAttribute("id"))});c.push(a);this.clearCheckedTreeNodes();this.openPath(c.join("/"));b.addClass("checked").find(">span:first").addClass("checked")}},getCurrentCheckedIds:function(){var a=[];this.element.find("li.checked,li.partchecked").not(".root").each(function(){a.push(this.getAttribute("id"))});
return a},clearCheckedTreeNodes:function(){this.element.find(".checked").removeClass("checked");this.element.find(".partchecked").removeClass("partchecked")},expandAll:function(b,c,e){b||(b=this.element.find("li:first"));this._expandNode(b,{treeElement:this.element},function(b){var d=b.treeElement;a(">ul>li",this).each(function(){d.tree("expandAll",a(this),c,e)});a.isFunction(c)&&c.apply(this)})},closeAll:function(a){a||(a=this.element.find("li:first"));a.removeClass("expanded");a.find(".expanded").removeClass("expanded");
a.find("ul").hide()},getTreeNodePath:function(a,b,c){var c=c||"/",e=[],f=this.element.find("li.treeNode#"+a);f.length&&(f.parents("li.treeNode").not(".root").each(function(){e.push(b?this.getAttribute("code"):this.getAttribute("id"))}),e=e.reverse(),e.push(b?b:a));return e.join(c)},destroy:function(){this.element.removeData(this.widgetName).removeClass("youi-tree").unbind()}}));a.extend(a.sdcui.tree,{defaults:{},getter:["getCurrentCheckedIds","getSelected","getTreeNodePath"],treeNodeHtml:function(a,
b,c,f){return e(a,b,c,f)}})})(jQuery);
